\hypertarget{group__file}{
\section{File interface}
\label{group__file}\index{File interface@{File interface}}
}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group__file_ga851cbf30c0a6d31a1733590cf80c39e5}{FILE\_\-CREATE\_\-DIRECTORY} 
\item 
enum \hyperlink{group__file_ga30d56f1f9c1a4d832c411ef51d9b276d}{FILE\_\-MODIFY\_\-PERMISSIONS} 
\item 
enum \hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME} 
\item 
enum \hyperlink{group__file_ga54c3c90d9cb7857114326cb5114e7159}{FILE\_\-EXISTS\_\-REPLACE} 
\item 
enum \hyperlink{group__file_ga99e741faa66e03cdb8738b717be227fd}{FILE\_\-EXISTS\_\-ERROR} 
\item 
enum \hyperlink{group__file_gaf208a7c7d7fd09276233583b22e4ee32}{FILE\_\-STATUS\_\-PERMANENT} 
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__file_ga0cd34cfd1bacb36b8ff82d01fb9a6f79}{file\_\-get\_\-stream\_\-wrappers} (\$filter=\hyperlink{stream__wrappers_8inc_aa396b3c5df01b437c006cf7ee9674f66}{STREAM\_\-WRAPPERS\_\-ALL})
\item 
\hyperlink{group__file_gaa31faf56baba0315a1867e2c1cc2b842}{file\_\-stream\_\-wrapper\_\-get\_\-class} (\$scheme)
\item 
\hyperlink{group__file_gaa98f967fe1033030e7e5262adda85463}{file\_\-uri\_\-scheme} (\$uri)
\item 
\hyperlink{group__file_ga12aebc3c6a9eb56d08511e7b968d0cef}{file\_\-stream\_\-wrapper\_\-valid\_\-scheme} (\$scheme)
\item 
\hyperlink{group__file_ga3137c530a505bcbaaeff3c4265f3f662}{file\_\-uri\_\-target} (\$uri)
\item 
\hyperlink{group__file_ga360bf8899ace3c977d257510651a763d}{file\_\-default\_\-scheme} ()
\item 
\hyperlink{group__file_gafd9a522999855ed89191e4e58bbbfeb3}{file\_\-stream\_\-wrapper\_\-uri\_\-normalize} (\$uri)
\item 
\hyperlink{group__file_ga2a693e908e5d4764c56f60b94070a635}{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri} (\$uri)
\item 
\hyperlink{group__file_ga6b037293e4cfecbabbd8db32191778a5}{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme} (\$scheme)
\item 
\hyperlink{group__file_gaee57f47d60bda90961a2e19d580d4908}{file\_\-create\_\-url} (\$uri)
\item 
\hyperlink{group__file_ga738f89421a4f4c228676de817e5e485c}{file\_\-prepare\_\-directory} (\&\$directory, \$options=\hyperlink{group__file_ga30d56f1f9c1a4d832c411ef51d9b276d}{FILE\_\-MODIFY\_\-PERMISSIONS})
\item 
\hyperlink{group__file_gabb0ecbecf4cff451bd30a4bbc3e2d57f}{file\_\-ensure\_\-htaccess} ()
\item 
\hyperlink{group__file_gaf30766eaa4c080c8d61a9aa0cf89739b}{file\_\-create\_\-htaccess} (\$directory, \$private=TRUE)
\item 
\hyperlink{group__file_ga32afa29695b6da3f5d86cad18f063bfc}{file\_\-load\_\-multiple} (\$fids=array(), \$conditions=array())
\item 
\hyperlink{group__file_ga138bd2e393c743b41a642003eecbf98f}{file\_\-load} (\$fid)
\item 
\hyperlink{group__file_ga80327cb23d8d384b827b2637cd8cc4ba}{file\_\-save} (stdClass \$file)
\item 
\hyperlink{group__file_ga6399c4096559ffbe81cfcb22db782bc4}{file\_\-usage\_\-list} (stdClass \$file)
\item 
\hyperlink{group__file_ga41a98960234fa8f802cfc1c4c769ae05}{file\_\-usage\_\-add} (stdClass \$file, \$module, \$type, \$id, \$count=1)
\item 
\hyperlink{group__file_gaf8562c4494373ec51079bb0999a8ae3a}{file\_\-usage\_\-delete} (stdClass \$file, \$module, \$type=NULL, \$id=NULL, \$count=1)
\item 
\hyperlink{group__file_gae49a2da7203ef43ae7adcf128d58d860}{file\_\-copy} (stdClass \$source, \$destination=NULL, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_gad84d226f677dd5b6e53519026b7de67e}{file\_\-valid\_\-uri} (\$uri)
\item 
\hyperlink{group__file_ga19b0d88682d26b7e5d03cb22ac2af391}{file\_\-unmanaged\_\-copy} (\$source, \$destination=NULL, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_ga6855ddd89be373ff7ea584d2ec66ea9a}{file\_\-build\_\-uri} (\$path)
\item 
\hyperlink{group__file_ga3136d98d6189607e6cba12aaff55c66d}{file\_\-destination} (\$destination, \$replace)
\item 
\hyperlink{group__file_gad6f4eec44e0c32bf0cde6c602d5da38f}{file\_\-move} (stdClass \$source, \$destination=NULL, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_ga3fd3a919ca321ec8c5bd1e4b069237a1}{file\_\-unmanaged\_\-move} (\$source, \$destination=NULL, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_gae5f97959982c78dfde2f806757c21368}{file\_\-munge\_\-filename} (\$filename, \$extensions, \$alerts=TRUE)
\item 
\hyperlink{group__file_gabda71018b91068bcd9fcd527a0493347}{file\_\-unmunge\_\-filename} (\$filename)
\item 
\hyperlink{group__file_ga057bbfa5f89c4e4c75f0030e6f1f3809}{file\_\-create\_\-filename} (\$basename, \$directory)
\item 
\hyperlink{group__file_gac7503f0dcdea965d68e4a242e7760921}{file\_\-delete} (stdClass \$file, \$force=FALSE)
\item 
\hyperlink{group__file_ga336a7e83da1397131e665d1c6e97fc83}{file\_\-unmanaged\_\-delete} (\$path)
\item 
\hyperlink{group__file_gaf5c2cffaaf70f0f62a513f033d814899}{file\_\-unmanaged\_\-delete\_\-recursive} (\$path)
\item 
\hyperlink{group__file_gade600fbda0056f4aaea634e7178215b2}{file\_\-space\_\-used} (\$uid=NULL, \$status=\hyperlink{group__file_gaf208a7c7d7fd09276233583b22e4ee32}{FILE\_\-STATUS\_\-PERMANENT})
\item 
\hyperlink{group__file_gaec0ce0fef696b3d4f9e0809c84bd8f41}{file\_\-save\_\-upload} (\$source, \$validators=array(), \$destination=FALSE, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_ga9edf58fdc552d61247bbf8322c434abf}{file\_\-validate} (stdClass \&\$file, \$validators=array())
\item 
\hyperlink{group__file_gaca56a55a4d3ee635cddf38903c1ed367}{file\_\-validate\_\-name\_\-length} (stdClass \$file)
\item 
\hyperlink{group__file_ga4036c6b78f904e5dd0273cf75eb474bb}{file\_\-validate\_\-extensions} (stdClass \$file, \$extensions)
\item 
\hyperlink{group__file_gad5dc623436b94f82d7a110adf8590915}{file\_\-validate\_\-size} (stdClass \$file, \$file\_\-limit=0, \$user\_\-limit=0)
\item 
\hyperlink{group__file_ga4cf6d97afe1580b23a14d96fede02d01}{file\_\-validate\_\-is\_\-image} (stdClass \$file)
\item 
\hyperlink{group__file_gaa90145fbf8065f644871c9d770e3cce4}{file\_\-validate\_\-image\_\-resolution} (stdClass \$file, \$maximum\_\-dimensions=0, \$minimum\_\-dimensions=0)
\item 
\hyperlink{group__file_ga7a01611c7c08b91876d93431207dd9b0}{file\_\-save\_\-data} (\$data, \$destination=NULL, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_gac2d047d4471ec93803f584cda01a557c}{file\_\-unmanaged\_\-save\_\-data} (\$data, \$destination=NULL, \$replace=\hyperlink{group__file_ga5d6636d4ccd022885823b91f17a0f464}{FILE\_\-EXISTS\_\-RENAME})
\item 
\hyperlink{group__file_ga7b047ab67ab5bb3882d573d7e06ab485}{file\_\-transfer} (\$uri, \$headers)
\item 
\hyperlink{group__file_ga91226299fab7e95a673f6461bbc19b02}{file\_\-download} ()
\item 
\hyperlink{group__file_ga363e988787ffa45bff69ff051eed0615}{file\_\-scan\_\-directory} (\$dir, \$mask, \$options=array(), \$depth=0)
\item 
\hyperlink{group__file_ga7cf25e6a2532a1d022ee1c655f895380}{file\_\-upload\_\-max\_\-size} ()
\item 
\hyperlink{group__file_ga2f3c500f59ecd606e4022ed9d83a1dec}{file\_\-get\_\-mimetype} (\$uri, \$mapping=NULL)
\item 
\hyperlink{group__file_ga250e5cfba54030ab1e5f031608860e42}{file\_\-directory\_\-temp} ()
\item 
\hyperlink{group__file_ga33aed1fe449367d57b8f9a774a449f27}{file\_\-get\_\-content\_\-headers} (\$file)
\item 
\hyperlink{group__file_gad391f02fb9f97bad982b7f66c1ce54d0}{file\_\-get\_\-file\_\-references} (\$file, \$field=NULL, \$age=\hyperlink{group__field_ga6eae4d17256be446f837da1a360f0096}{FIELD\_\-LOAD\_\-REVISION}, \$field\_\-type= 'file')
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manually include stream wrapper code.

Stream wrapper code is included here because there are cases where File API is needed before a bootstrap, or in an alternate order (e.g. maintenance theme).

Common file handling functions.

Fields on the file object:
\begin{DoxyItemize}
\item fid: File ID
\item uid: The \{users\}.uid of the user who is associated with the file.
\item filename: Name of the file with no path components. This may differ from the basename of the filepath if the file is renamed to avoid overwriting an existing file.
\item uri: URI of the file.
\item filemime: The file's MIME type.
\item filesize: The size of the file in bytes.
\item status: A bitmapped field indicating the status of the file. The first 8 bits are reserved for Drupal core. The least significant bit indicates temporary (0) or permanent (1). Temporary files older than DRUPAL\_\-MAXIMUM\_\-TEMP\_\-FILE\_\-AGE will be removed during cron runs.
\item timestamp: UNIX timestamp for the date the file was added to the database.
\end{DoxyItemize}

These functions may be used to determine if and where a file is in use. 

\subsection{Enumeration Type Documentation}
\hypertarget{group__file_ga851cbf30c0a6d31a1733590cf80c39e5}{
\index{file@{file}!FILE\_\-CREATE\_\-DIRECTORY@{FILE\_\-CREATE\_\-DIRECTORY}}
\index{FILE\_\-CREATE\_\-DIRECTORY@{FILE\_\-CREATE\_\-DIRECTORY}!file@{file}}
\subsubsection[{FILE\_\-CREATE\_\-DIRECTORY}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FILE\_\-CREATE\_\-DIRECTORY}}}
\label{group__file_ga851cbf30c0a6d31a1733590cf80c39e5}
Flag used by \hyperlink{group__file_ga738f89421a4f4c228676de817e5e485c}{file\_\-prepare\_\-directory()} -\/-\/ create directory if not present. \hypertarget{group__file_ga99e741faa66e03cdb8738b717be227fd}{
\index{file@{file}!FILE\_\-EXISTS\_\-ERROR@{FILE\_\-EXISTS\_\-ERROR}}
\index{FILE\_\-EXISTS\_\-ERROR@{FILE\_\-EXISTS\_\-ERROR}!file@{file}}
\subsubsection[{FILE\_\-EXISTS\_\-ERROR}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FILE\_\-EXISTS\_\-ERROR}}}
\label{group__file_ga99e741faa66e03cdb8738b717be227fd}
Flag for dealing with existing files: Do nothing and return FALSE. \hypertarget{group__file_ga5d6636d4ccd022885823b91f17a0f464}{
\index{file@{file}!FILE\_\-EXISTS\_\-RENAME@{FILE\_\-EXISTS\_\-RENAME}}
\index{FILE\_\-EXISTS\_\-RENAME@{FILE\_\-EXISTS\_\-RENAME}!file@{file}}
\subsubsection[{FILE\_\-EXISTS\_\-RENAME}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FILE\_\-EXISTS\_\-RENAME}}}
\label{group__file_ga5d6636d4ccd022885823b91f17a0f464}
Flag for dealing with existing files: Appends number until name is unique. \hypertarget{group__file_ga54c3c90d9cb7857114326cb5114e7159}{
\index{file@{file}!FILE\_\-EXISTS\_\-REPLACE@{FILE\_\-EXISTS\_\-REPLACE}}
\index{FILE\_\-EXISTS\_\-REPLACE@{FILE\_\-EXISTS\_\-REPLACE}!file@{file}}
\subsubsection[{FILE\_\-EXISTS\_\-REPLACE}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FILE\_\-EXISTS\_\-REPLACE}}}
\label{group__file_ga54c3c90d9cb7857114326cb5114e7159}
Flag for dealing with existing files: Replace the existing file. \hypertarget{group__file_ga30d56f1f9c1a4d832c411ef51d9b276d}{
\index{file@{file}!FILE\_\-MODIFY\_\-PERMISSIONS@{FILE\_\-MODIFY\_\-PERMISSIONS}}
\index{FILE\_\-MODIFY\_\-PERMISSIONS@{FILE\_\-MODIFY\_\-PERMISSIONS}!file@{file}}
\subsubsection[{FILE\_\-MODIFY\_\-PERMISSIONS}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FILE\_\-MODIFY\_\-PERMISSIONS}}}
\label{group__file_ga30d56f1f9c1a4d832c411ef51d9b276d}
Flag used by \hyperlink{group__file_ga738f89421a4f4c228676de817e5e485c}{file\_\-prepare\_\-directory()} -\/-\/ file permissions may be changed. \hypertarget{group__file_gaf208a7c7d7fd09276233583b22e4ee32}{
\index{file@{file}!FILE\_\-STATUS\_\-PERMANENT@{FILE\_\-STATUS\_\-PERMANENT}}
\index{FILE\_\-STATUS\_\-PERMANENT@{FILE\_\-STATUS\_\-PERMANENT}!file@{file}}
\subsubsection[{FILE\_\-STATUS\_\-PERMANENT}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FILE\_\-STATUS\_\-PERMANENT}}}
\label{group__file_gaf208a7c7d7fd09276233583b22e4ee32}
Indicates that the file is permanent and should not be deleted.

Temporary files older than DRUPAL\_\-MAXIMUM\_\-TEMP\_\-FILE\_\-AGE will be removed during cron runs, but permanent files will not be removed during the file garbage collection process. 

\subsection{Function Documentation}
\hypertarget{group__file_ga6855ddd89be373ff7ea584d2ec66ea9a}{
\index{file@{file}!file\_\-build\_\-uri@{file\_\-build\_\-uri}}
\index{file\_\-build\_\-uri@{file\_\-build\_\-uri}!file@{file}}
\subsubsection[{file\_\-build\_\-uri}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-build\_\-uri (\$ {\em path})}}
\label{group__file_ga6855ddd89be373ff7ea584d2ec66ea9a}
Constructs a URI to Drupal's default files location given a relative path. \hypertarget{group__file_gae49a2da7203ef43ae7adcf128d58d860}{
\index{file@{file}!file\_\-copy@{file\_\-copy}}
\index{file\_\-copy@{file\_\-copy}!file@{file}}
\subsubsection[{file\_\-copy}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-copy (stdClass \$ {\em source}, \/  \$ {\em destination} = {\ttfamily NULL}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_gae49a2da7203ef43ae7adcf128d58d860}
Copies a file to a new location and adds a file record to the database.

This function should be used when manipulating files that have records stored in the database. This is a powerful function that in many ways performs like an advanced version of copy().
\begin{DoxyItemize}
\item Checks if \$source and \$destination are valid and readable/writable.
\item Checks that \$source is not equal to \$destination; if they are an error is reported.
\item If file already exists in \$destination either the call will error out, replace the file or rename the file based on the \$replace parameter.
\item Adds the new file to the files database. If the source file is a temporary file, the resulting file will also be a temporary file. See \hyperlink{group__file_gaec0ce0fef696b3d4f9e0809c84bd8f41}{file\_\-save\_\-upload()} for details on temporary files.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$source}]A file object. \item[{\em \$destination}]A string containing the destination that \$source should be copied to. This must be a stream wrapper URI. \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file. If a managed file with the destination name exists then its database entry will be updated. If no database entry is found then a new one will be created.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
File object if the copy is successful, or FALSE in the event of an error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga19b0d88682d26b7e5d03cb22ac2af391}{file\_\-unmanaged\_\-copy()} 

\hyperlink{group__hooks_ga49e2e5f9993e98da69c3434999242711}{hook\_\-file\_\-copy()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga057bbfa5f89c4e4c75f0030e6f1f3809}{
\index{file@{file}!file\_\-create\_\-filename@{file\_\-create\_\-filename}}
\index{file\_\-create\_\-filename@{file\_\-create\_\-filename}!file@{file}}
\subsubsection[{file\_\-create\_\-filename}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-create\_\-filename (\$ {\em basename}, \/  \$ {\em directory})}}
\label{group__file_ga057bbfa5f89c4e4c75f0030e6f1f3809}
Creates a full file path from a directory and filename.

If a file with the specified name already exists, an alternative will be used.


\begin{DoxyParams}{Parameters}
\item[{\em \$basename}]String filename \item[{\em \$directory}]String containing the directory or parent URI.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
File path consisting of \$directory and a unique filename based off of \$basename. 
\end{DoxyReturn}
\hypertarget{group__file_gaf30766eaa4c080c8d61a9aa0cf89739b}{
\index{file@{file}!file\_\-create\_\-htaccess@{file\_\-create\_\-htaccess}}
\index{file\_\-create\_\-htaccess@{file\_\-create\_\-htaccess}!file@{file}}
\subsubsection[{file\_\-create\_\-htaccess}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-create\_\-htaccess (\$ {\em directory}, \/  \$ {\em private} = {\ttfamily TRUE})}}
\label{group__file_gaf30766eaa4c080c8d61a9aa0cf89739b}
Creates a .htaccess file in the given directory.


\begin{DoxyParams}{Parameters}
\item[{\em \$directory}]The directory. \item[{\em \$private}]FALSE indicates that \$directory should be an open and public directory. The default is TRUE which indicates a private and protected directory. \end{DoxyParams}
\hypertarget{group__file_gaee57f47d60bda90961a2e19d580d4908}{
\index{file@{file}!file\_\-create\_\-url@{file\_\-create\_\-url}}
\index{file\_\-create\_\-url@{file\_\-create\_\-url}!file@{file}}
\subsubsection[{file\_\-create\_\-url}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-create\_\-url (\$ {\em uri})}}
\label{group__file_gaee57f47d60bda90961a2e19d580d4908}
Creates a web-\/accessible URL for a stream to an external or local file.

Compatibility: normal paths and stream wrappers.

There are two kinds of local files:
\begin{DoxyItemize}
\item \char`\"{}managed files\char`\"{}, i.e. those stored by a Drupal-\/compatible stream wrapper. These are files that have either been uploaded by users or were generated automatically (for example through CSS aggregation).
\item \char`\"{}shipped files\char`\"{}, i.e. those outside of the files directory, which ship as part of Drupal core or contributed modules or themes.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]The URI to a file for which we need an external URL, or the path to a shipped file.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string containing a URL that may be used to access the file. If the provided string already contains a preceding 'http', 'https', or '/', nothing is done and the same string is returned. If a stream wrapper could not be found to generate an external URL, then FALSE is returned.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\href{http://drupal.org/node/515192}{\tt http://drupal.org/node/515192} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga360bf8899ace3c977d257510651a763d}{
\index{file@{file}!file\_\-default\_\-scheme@{file\_\-default\_\-scheme}}
\index{file\_\-default\_\-scheme@{file\_\-default\_\-scheme}!file@{file}}
\subsubsection[{file\_\-default\_\-scheme}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-default\_\-scheme ()}}
\label{group__file_ga360bf8899ace3c977d257510651a763d}
Gets the default file stream implementation.

\begin{DoxyReturn}{Returns}
'public', 'private' or any other file scheme defined as the default. 
\end{DoxyReturn}
\hypertarget{group__file_gac7503f0dcdea965d68e4a242e7760921}{
\index{file@{file}!file\_\-delete@{file\_\-delete}}
\index{file\_\-delete@{file\_\-delete}!file@{file}}
\subsubsection[{file\_\-delete}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-delete (stdClass \$ {\em file}, \/  \$ {\em force} = {\ttfamily FALSE})}}
\label{group__file_gac7503f0dcdea965d68e4a242e7760921}
Deletes a file and its database record.

If the \$force parameter is not TRUE, \hyperlink{group__file_ga6399c4096559ffbe81cfcb22db782bc4}{file\_\-usage\_\-list()} will be called to determine if the file is being used by any modules. If the file is being used the delete will be canceled.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object. \item[{\em \$force}]Boolean indicating that the file should be deleted even if the file is reported as in use by the file\_\-usage table.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
mixed TRUE for success, FALSE in the event of an error, or an array if the file is being used by any modules.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga336a7e83da1397131e665d1c6e97fc83}{file\_\-unmanaged\_\-delete()} 

\hyperlink{group__file_ga6399c4096559ffbe81cfcb22db782bc4}{file\_\-usage\_\-list()} 

\hyperlink{group__file_gaf8562c4494373ec51079bb0999a8ae3a}{file\_\-usage\_\-delete()} 

\hyperlink{group__hooks_gafa88683ad014451b3fbc9ca9bb80afdd}{hook\_\-file\_\-delete()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga3136d98d6189607e6cba12aaff55c66d}{
\index{file@{file}!file\_\-destination@{file\_\-destination}}
\index{file\_\-destination@{file\_\-destination}!file@{file}}
\subsubsection[{file\_\-destination}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-destination (\$ {\em destination}, \/  \$ {\em replace})}}
\label{group__file_ga3136d98d6189607e6cba12aaff55c66d}
Determines the destination path for a file.


\begin{DoxyParams}{Parameters}
\item[{\em \$destination}]A string specifying the desired final URI or filepath. \item[{\em \$replace}]Replace behavior when the destination file already exists.
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The destination filepath, or FALSE if the file already exists and FILE\_\-EXISTS\_\-ERROR is specified. 
\end{DoxyReturn}
\hypertarget{group__file_ga250e5cfba54030ab1e5f031608860e42}{
\index{file@{file}!file\_\-directory\_\-temp@{file\_\-directory\_\-temp}}
\index{file\_\-directory\_\-temp@{file\_\-directory\_\-temp}!file@{file}}
\subsubsection[{file\_\-directory\_\-temp}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-directory\_\-temp ()}}
\label{group__file_ga250e5cfba54030ab1e5f031608860e42}
Gets the path of system-\/appropriate temporary directory. \hypertarget{group__file_ga91226299fab7e95a673f6461bbc19b02}{
\index{file@{file}!file\_\-download@{file\_\-download}}
\index{file\_\-download@{file\_\-download}!file@{file}}
\subsubsection[{file\_\-download}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-download ()}}
\label{group__file_ga91226299fab7e95a673f6461bbc19b02}
Menu handler for private file transfers.

Call modules that implement \hyperlink{group__hooks_gab73f0e658d6630220ba7836ccd011ecc}{hook\_\-file\_\-download()} to find out if a file is accessible and what headers it should be transferred with. If one or more modules returned headers the download will start with the returned headers. If a module returns -\/1 \hyperlink{group__http__handling_ga0bbff371f9373002e71f2e1347fcf481}{drupal\_\-access\_\-denied()} will be returned. If the file exists but no modules responded \hyperlink{group__http__handling_ga0bbff371f9373002e71f2e1347fcf481}{drupal\_\-access\_\-denied()} will be returned. If the file does not exist \hyperlink{group__http__handling_ga52b08cd98e1756326c1bd5b56c39a884}{drupal\_\-not\_\-found()} will be returned.

\begin{DoxySeeAlso}{See also}
\hyperlink{system_8module_ae25cda0ea4fd63936e8f955dd9cfc269}{system\_\-menu()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gabb0ecbecf4cff451bd30a4bbc3e2d57f}{
\index{file@{file}!file\_\-ensure\_\-htaccess@{file\_\-ensure\_\-htaccess}}
\index{file\_\-ensure\_\-htaccess@{file\_\-ensure\_\-htaccess}!file@{file}}
\subsubsection[{file\_\-ensure\_\-htaccess}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-ensure\_\-htaccess ()}}
\label{group__file_gabb0ecbecf4cff451bd30a4bbc3e2d57f}
Creates a .htaccess file in each Drupal files directory if it is missing. \hypertarget{group__file_ga33aed1fe449367d57b8f9a774a449f27}{
\index{file@{file}!file\_\-get\_\-content\_\-headers@{file\_\-get\_\-content\_\-headers}}
\index{file\_\-get\_\-content\_\-headers@{file\_\-get\_\-content\_\-headers}!file@{file}}
\subsubsection[{file\_\-get\_\-content\_\-headers}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-get\_\-content\_\-headers (\$ {\em file})}}
\label{group__file_ga33aed1fe449367d57b8f9a774a449f27}
Examines a file object and returns appropriate content headers for download.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An associative array of headers, as expected by \hyperlink{group__file_ga7b047ab67ab5bb3882d573d7e06ab485}{file\_\-transfer()}. 
\end{DoxyReturn}
\hypertarget{group__file_gad391f02fb9f97bad982b7f66c1ce54d0}{
\index{file@{file}!file\_\-get\_\-file\_\-references@{file\_\-get\_\-file\_\-references}}
\index{file\_\-get\_\-file\_\-references@{file\_\-get\_\-file\_\-references}!file@{file}}
\subsubsection[{file\_\-get\_\-file\_\-references}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-get\_\-file\_\-references (\$ {\em file}, \/  \$ {\em field} = {\ttfamily NULL}, \/  \$ {\em age} = {\ttfamily {\bf FIELD\_\-LOAD\_\-REVISION}}, \/  \$ {\em field\_\-type} = {\ttfamily 'file'})}}
\label{group__file_gad391f02fb9f97bad982b7f66c1ce54d0}
Retrieves a list of references to a file.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object. \item[{\em \$field}](optional) A field array to be used for this check. If given, limits the reference check to the given field. \item[{\em \$age}](optional) A constant that specifies which references to count. Use FIELD\_\-LOAD\_\-REVISION to retrieve all references within all revisions or FIELD\_\-LOAD\_\-CURRENT to retrieve references only in the current revisions. \item[{\em \$field\_\-type}](optional) The name of a field type. If given, limits the reference check to fields of the given type.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer value. 
\end{DoxyReturn}
\hypertarget{group__file_ga2f3c500f59ecd606e4022ed9d83a1dec}{
\index{file@{file}!file\_\-get\_\-mimetype@{file\_\-get\_\-mimetype}}
\index{file\_\-get\_\-mimetype@{file\_\-get\_\-mimetype}!file@{file}}
\subsubsection[{file\_\-get\_\-mimetype}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-get\_\-mimetype (\$ {\em uri}, \/  \$ {\em mapping} = {\ttfamily NULL})}}
\label{group__file_ga2f3c500f59ecd606e4022ed9d83a1dec}
Determines an Internet Media Type or MIME type from a filename.


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]A string containing the URI, path, or filename. \item[{\em \$mapping}]An optional map of extensions to their mimetypes, in the form:
\begin{DoxyItemize}
\item 'mimetypes': a list of mimetypes, keyed by an identifier,
\item 'extensions': the mapping itself, an associative array in which the key is the extension (lowercase) and the value is the mimetype identifier. If \$mapping is NULL \hyperlink{file_8mimetypes_8inc_a92dcd553bb93d58cd4e25c1dc64c7386}{file\_\-mimetype\_\-mapping()} is called.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The internet media type registered for the extension or application/octet-\/stream for unknown extensions.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{file_8mimetypes_8inc_a8a8064ffcafb048d0c7dd61ba261b876}{file\_\-default\_\-mimetype\_\-mapping()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga0cd34cfd1bacb36b8ff82d01fb9a6f79}{
\index{file@{file}!file\_\-get\_\-stream\_\-wrappers@{file\_\-get\_\-stream\_\-wrappers}}
\index{file\_\-get\_\-stream\_\-wrappers@{file\_\-get\_\-stream\_\-wrappers}!file@{file}}
\subsubsection[{file\_\-get\_\-stream\_\-wrappers}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-get\_\-stream\_\-wrappers (\$ {\em filter} = {\ttfamily {\bf STREAM\_\-WRAPPERS\_\-ALL}})}}
\label{group__file_ga0cd34cfd1bacb36b8ff82d01fb9a6f79}
Provides Drupal stream wrapper registry.

A stream wrapper is an abstraction of a file system that allows Drupal to use the same set of methods to access both local files and remote resources.

Provide a facility for managing and querying user-\/defined stream wrappers in PHP. PHP's internal stream\_\-get\_\-wrappers() doesn't return the class registered to handle a stream, which we need to be able to find the handler for class instantiation.

If a module registers a scheme that is already registered with PHP, the existing scheme will be unregistered and replaced with the specified class.

A stream is referenced as \char`\"{}scheme://target\char`\"{}.

The optional \$filter parameter can be used to retrieve only the stream wrappers that are appropriate for particular usage. For example, this returns only stream wrappers that use local file storage: 
\begin{DoxyCode}
   $local_stream_wrappers = file_get_stream_wrappers(STREAM_WRAPPERS_LOCAL);
\end{DoxyCode}


The \$filter parameter can only filter to types containing a particular flag. In some cases, you may want to filter to types that do not contain a particular flag. For example, you may want to retrieve all stream wrappers that are not writable, or all stream wrappers that are not local. PHP's array\_\-diff\_\-key() function can be used to help with this. For example, this returns only stream wrappers that do not use local file storage: 
\begin{DoxyCode}
   $remote_stream_wrappers = array_diff_key(file_get_stream_wrappers(
      STREAM_WRAPPERS_ALL), file_get_stream_wrappers(STREAM_WRAPPERS_LOCAL));
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
\item[{\em \$filter}](Optional) Filters out all types except those with an on bit for each on bit in \$filter. For example, if \$filter is STREAM\_\-WRAPPERS\_\-WRITE\_\-VISIBLE, which is equal to (STREAM\_\-WRAPPERS\_\-READ $|$ STREAM\_\-WRAPPERS\_\-WRITE $|$ STREAM\_\-WRAPPERS\_\-VISIBLE), then only stream wrappers with all three of these bits set are returned. Defaults to STREAM\_\-WRAPPERS\_\-ALL, which returns all registered stream wrappers.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array keyed by scheme, with values containing an array of information about the stream wrapper, as returned by \hyperlink{group__hooks_ga6fadcf625a4766e7f0d97b1628b294dc}{hook\_\-stream\_\-wrappers()}. If \$filter is omitted or set to STREAM\_\-WRAPPERS\_\-ALL, the entire Drupal stream wrapper registry is returned. Otherwise only the stream wrappers whose 'type' bitmask has an on bit for each bit specified in \$filter are returned.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_ga6fadcf625a4766e7f0d97b1628b294dc}{hook\_\-stream\_\-wrappers()} 

\hyperlink{group__hooks_gab7e34e537f28b019b04ab1b1d90d52c1}{hook\_\-stream\_\-wrappers\_\-alter()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga138bd2e393c743b41a642003eecbf98f}{
\index{file@{file}!file\_\-load@{file\_\-load}}
\index{file\_\-load@{file\_\-load}!file@{file}}
\subsubsection[{file\_\-load}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-load (\$ {\em fid})}}
\label{group__file_ga138bd2e393c743b41a642003eecbf98f}
Loads a single file object from the database.


\begin{DoxyParams}{Parameters}
\item[{\em \$fid}]A file ID.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An object representing the file, or FALSE if the file was not found.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_ga9f6bf6919600b83a565421f6a7faf678}{hook\_\-file\_\-load()} 

\hyperlink{group__file_ga32afa29695b6da3f5d86cad18f063bfc}{file\_\-load\_\-multiple()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga32afa29695b6da3f5d86cad18f063bfc}{
\index{file@{file}!file\_\-load\_\-multiple@{file\_\-load\_\-multiple}}
\index{file\_\-load\_\-multiple@{file\_\-load\_\-multiple}!file@{file}}
\subsubsection[{file\_\-load\_\-multiple}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-load\_\-multiple (\$ {\em fids} = {\ttfamily array()}, \/  \$ {\em conditions} = {\ttfamily array()})}}
\label{group__file_ga32afa29695b6da3f5d86cad18f063bfc}
Loads file objects from the database.


\begin{DoxyParams}{Parameters}
\item[{\em \$fids}]An array of file IDs. \item[{\em \$conditions}](deprecated) An associative array of conditions on the \{file\_\-managed\} table, where the keys are the database fields and the values are the values those fields must have. Instead, it is preferable to use \hyperlink{classEntityFieldQuery}{EntityFieldQuery} to retrieve a list of entity IDs loadable by this function.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array of file objects, indexed by fid.
\end{DoxyReturn}
\begin{Desc}
\item[\hyperlink{todo__todo000004}{Todo}]Remove \$conditions in Drupal 8.\end{Desc}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_ga9f6bf6919600b83a565421f6a7faf678}{hook\_\-file\_\-load()} 

\hyperlink{group__file_ga138bd2e393c743b41a642003eecbf98f}{file\_\-load()} 

\hyperlink{common_8inc_a78b89cf93f9710a68d02f86adccf1898}{entity\_\-load()} 

\hyperlink{classEntityFieldQuery}{EntityFieldQuery} 
\end{DoxySeeAlso}
\hypertarget{group__file_gad6f4eec44e0c32bf0cde6c602d5da38f}{
\index{file@{file}!file\_\-move@{file\_\-move}}
\index{file\_\-move@{file\_\-move}!file@{file}}
\subsubsection[{file\_\-move}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-move (stdClass \$ {\em source}, \/  \$ {\em destination} = {\ttfamily NULL}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_gad6f4eec44e0c32bf0cde6c602d5da38f}
Moves a file to a new location and update the file's database entry.

Moving a file is performed by copying the file to the new location and then deleting the original.
\begin{DoxyItemize}
\item Checks if \$source and \$destination are valid and readable/writable.
\item Performs a file move if \$source is not equal to \$destination.
\item If file already exists in \$destination either the call will error out, replace the file or rename the file based on the \$replace parameter.
\item Adds the new file to the files database.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$source}]A file object. \item[{\em \$destination}]A string containing the destination that \$source should be moved to. This must be a stream wrapper URI. \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file. If a managed file with the destination name exists then its database entry will be updated and \hyperlink{group__file_gac7503f0dcdea965d68e4a242e7760921}{file\_\-delete()} called on the source file after hook\_\-file\_\-move is called. If no database entry is found then the source files record will be updated.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Resulting file object for success, or FALSE in the event of an error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga3fd3a919ca321ec8c5bd1e4b069237a1}{file\_\-unmanaged\_\-move()} 

\hyperlink{group__hooks_ga7053514a7a923b43960b31cacfa9ce95}{hook\_\-file\_\-move()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gae5f97959982c78dfde2f806757c21368}{
\index{file@{file}!file\_\-munge\_\-filename@{file\_\-munge\_\-filename}}
\index{file\_\-munge\_\-filename@{file\_\-munge\_\-filename}!file@{file}}
\subsubsection[{file\_\-munge\_\-filename}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-munge\_\-filename (\$ {\em filename}, \/  \$ {\em extensions}, \/  \$ {\em alerts} = {\ttfamily TRUE})}}
\label{group__file_gae5f97959982c78dfde2f806757c21368}
Modifies a filename as needed for security purposes.

Munging a file name prevents unknown file extensions from masking exploit files. When web servers such as Apache decide how to process a URL request, they use the file extension. If the extension is not recognized, Apache skips that extension and uses the previous file extension. For example, if the file being requested is exploit.php.pps, and Apache does not recognize the '.pps' extension, it treats the file as PHP and executes it. To make this file name safe for Apache and prevent it from executing as PHP, the .php extension is \char`\"{}munged\char`\"{} into .php\_\-, making the safe file name exploit.php\_\-.pps.

Specifically, this function adds an underscore to all extensions that are between 2 and 5 characters in length, internal to the file name, and not included in \$extensions.

Function behavior is also controlled by the Drupal variable 'allow\_\-insecure\_\-uploads'. If 'allow\_\-insecure\_\-uploads' evaluates to TRUE, no alterations will be made, if it evaluates to FALSE, the filename is 'munged'.


\begin{DoxyParams}{Parameters}
\item[{\em \$filename}]File name to modify. \item[{\em \$extensions}]A space-\/separated list of extensions that should not be altered. \item[{\em \$alerts}]If TRUE, \hyperlink{bootstrap_8inc_ad9223d86c7b08b1288274ce211d9bfa6}{drupal\_\-set\_\-message()} will be called to display a message if the file name was changed.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The potentially modified \$filename. 
\end{DoxyReturn}
\hypertarget{group__file_ga738f89421a4f4c228676de817e5e485c}{
\index{file@{file}!file\_\-prepare\_\-directory@{file\_\-prepare\_\-directory}}
\index{file\_\-prepare\_\-directory@{file\_\-prepare\_\-directory}!file@{file}}
\subsubsection[{file\_\-prepare\_\-directory}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-prepare\_\-directory (\&\$ {\em directory}, \/  \$ {\em options} = {\ttfamily {\bf FILE\_\-MODIFY\_\-PERMISSIONS}})}}
\label{group__file_ga738f89421a4f4c228676de817e5e485c}
Checks that the directory exists and is writable.

Directories need to have execute permissions to be considered a directory by FTP servers, etc.


\begin{DoxyParams}{Parameters}
\item[{\em \$directory}]A string reference containing the name of a directory path or URI. A trailing slash will be trimmed from a path. \item[{\em \$options}]A bitmask to indicate if the directory should be created if it does not exist (FILE\_\-CREATE\_\-DIRECTORY) or made writable if it is read-\/only (FILE\_\-MODIFY\_\-PERMISSIONS).\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE if the directory exists (or was created) and is writable. FALSE otherwise. 
\end{DoxyReturn}
\hypertarget{group__file_ga80327cb23d8d384b827b2637cd8cc4ba}{
\index{file@{file}!file\_\-save@{file\_\-save}}
\index{file\_\-save@{file\_\-save}!file@{file}}
\subsubsection[{file\_\-save}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-save (stdClass \$ {\em file})}}
\label{group__file_ga80327cb23d8d384b827b2637cd8cc4ba}
Saves a file object to the database.

If the \$file-\/$>$fid is not set a new record will be added.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object returned by \hyperlink{group__file_ga138bd2e393c743b41a642003eecbf98f}{file\_\-load()}.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The updated file object.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_gac40fa27583fc4cba927f486098eaa79b}{hook\_\-file\_\-insert()} 

\hyperlink{group__hooks_ga604abda1f5df3f041f7ef748b9762475}{hook\_\-file\_\-update()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga7a01611c7c08b91876d93431207dd9b0}{
\index{file@{file}!file\_\-save\_\-data@{file\_\-save\_\-data}}
\index{file\_\-save\_\-data@{file\_\-save\_\-data}!file@{file}}
\subsubsection[{file\_\-save\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-save\_\-data (\$ {\em data}, \/  \$ {\em destination} = {\ttfamily NULL}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_ga7a01611c7c08b91876d93431207dd9b0}
Saves a file to the specified destination and creates a database entry.


\begin{DoxyParams}{Parameters}
\item[{\em \$data}]A string containing the contents of the file. \item[{\em \$destination}]A string containing the destination URI. This must be a stream wrapper URI. If no value is provided, a randomized name will be generated and the file will be saved using Drupal's default files scheme, usually \char`\"{}public://\char`\"{}. \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file. If a managed file with the destination name exists then its database entry will be updated. If no database entry is found then a new one will be created.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A file object, or FALSE on error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_gac2d047d4471ec93803f584cda01a557c}{file\_\-unmanaged\_\-save\_\-data()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gaec0ce0fef696b3d4f9e0809c84bd8f41}{
\index{file@{file}!file\_\-save\_\-upload@{file\_\-save\_\-upload}}
\index{file\_\-save\_\-upload@{file\_\-save\_\-upload}!file@{file}}
\subsubsection[{file\_\-save\_\-upload}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-save\_\-upload (\$ {\em source}, \/  \$ {\em validators} = {\ttfamily array()}, \/  \$ {\em destination} = {\ttfamily FALSE}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_gaec0ce0fef696b3d4f9e0809c84bd8f41}
Saves a file upload to a new location.

The file will be added to the \{file\_\-managed\} table as a temporary file. Temporary files are periodically cleaned. To make the file a permanent file, assign the status and use \hyperlink{group__file_ga80327cb23d8d384b827b2637cd8cc4ba}{file\_\-save()} to save the changes.


\begin{DoxyParams}{Parameters}
\item[{\em \$source}]A string specifying the filepath or URI of the uploaded file to save. \item[{\em \$validators}]An optional, associative array of callback functions used to validate the file. See \hyperlink{group__file_ga9edf58fdc552d61247bbf8322c434abf}{file\_\-validate()} for a full discussion of the array format. If no extension validator is provided it will default to a limited safe list of extensions which is as follows: \char`\"{}jpg jpeg gif png txt
   doc xls pdf ppt pps odt ods odp\char`\"{}. To allow all extensions you must explicitly set the 'file\_\-validate\_\-extensions' validator to an empty array (Beware: this is not safe and should only be allowed for trusted users, if at all). \item[{\em \$destination}]A string containing the URI \$source should be copied to. This must be a stream wrapper URI. If this value is omitted, Drupal's temporary files scheme will be used (\char`\"{}temporary://\char`\"{}). \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE: Replace the existing file.
\item FILE\_\-EXISTS\_\-RENAME: Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR: Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An object containing the file information if the upload succeeded, FALSE in the event of an error, or NULL if no file was uploaded. The documentation for the \char`\"{}File interface\char`\"{} group, which you can find under Related topics, or the header at the top of this file, documents the components of a file object. In addition to the standard components, this function adds:
\begin{DoxyItemize}
\item source: Path to the file before it is moved.
\item destination: Path to the file after it is moved (same as 'uri'). 
\end{DoxyItemize}
\end{DoxyReturn}
\hypertarget{group__file_ga363e988787ffa45bff69ff051eed0615}{
\index{file@{file}!file\_\-scan\_\-directory@{file\_\-scan\_\-directory}}
\index{file\_\-scan\_\-directory@{file\_\-scan\_\-directory}!file@{file}}
\subsubsection[{file\_\-scan\_\-directory}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-scan\_\-directory (\$ {\em dir}, \/  \$ {\em mask}, \/  \$ {\em options} = {\ttfamily array()}, \/  \$ {\em depth} = {\ttfamily 0})}}
\label{group__file_ga363e988787ffa45bff69ff051eed0615}
Finds all files that match a given mask in a given directory.

Directories and files beginning with a period are excluded; this prevents hidden files and directories (such as SVN working directories) from being scanned.


\begin{DoxyParams}{Parameters}
\item[{\em \$dir}]The base directory or URI to scan, without trailing slash. \item[{\em \$mask}]The preg\_\-match() regular expression of the files to find. \item[{\em \$options}]An associative array of additional options, with the following elements:
\begin{DoxyItemize}
\item 'nomask': The preg\_\-match() regular expression of the files to ignore. Defaults to '/($\backslash$.$\backslash$.?$|$CVS)\$/'.
\item 'callback': The callback function to call for each match. There is no default callback.
\item 'recurse': When TRUE, the directory scan will recurse the entire tree starting at the provided directory. Defaults to TRUE.
\item 'key': The key to be used for the returned associative array of files. Possible values are 'uri', for the file's URI; 'filename', for the basename of the file; and 'name' for the name of the file without the extension. Defaults to 'uri'.
\item 'min\_\-depth': Minimum depth of directories to return files from. Defaults to 0. 
\end{DoxyItemize}\item[{\em \$depth}]Current depth of recursion. This parameter is only used internally and should not be passed in.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An associative array (keyed on the chosen key) of objects with 'uri', 'filename', and 'name' members corresponding to the matching files. 
\end{DoxyReturn}
\hypertarget{group__file_gade600fbda0056f4aaea634e7178215b2}{
\index{file@{file}!file\_\-space\_\-used@{file\_\-space\_\-used}}
\index{file\_\-space\_\-used@{file\_\-space\_\-used}!file@{file}}
\subsubsection[{file\_\-space\_\-used}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-space\_\-used (\$ {\em uid} = {\ttfamily NULL}, \/  \$ {\em status} = {\ttfamily {\bf FILE\_\-STATUS\_\-PERMANENT}})}}
\label{group__file_gade600fbda0056f4aaea634e7178215b2}
Determines total disk space used by a single user or the whole filesystem.


\begin{DoxyParams}{Parameters}
\item[{\em \$uid}]Optional. A user id, specifying NULL returns the total space used by all non-\/temporary files. \item[{\em \$status}]Optional. The file status to consider. The default is to only consider files in status FILE\_\-STATUS\_\-PERMANENT.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer containing the number of bytes used. 
\end{DoxyReturn}
\hypertarget{group__file_gaa31faf56baba0315a1867e2c1cc2b842}{
\index{file@{file}!file\_\-stream\_\-wrapper\_\-get\_\-class@{file\_\-stream\_\-wrapper\_\-get\_\-class}}
\index{file\_\-stream\_\-wrapper\_\-get\_\-class@{file\_\-stream\_\-wrapper\_\-get\_\-class}!file@{file}}
\subsubsection[{file\_\-stream\_\-wrapper\_\-get\_\-class}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-stream\_\-wrapper\_\-get\_\-class (\$ {\em scheme})}}
\label{group__file_gaa31faf56baba0315a1867e2c1cc2b842}
Returns the stream wrapper class name for a given scheme.


\begin{DoxyParams}{Parameters}
\item[{\em \$scheme}]Stream scheme.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return string if a scheme has a registered handler, or FALSE. 
\end{DoxyReturn}
\hypertarget{group__file_ga6b037293e4cfecbabbd8db32191778a5}{
\index{file@{file}!file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme@{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme}}
\index{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme@{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme}!file@{file}}
\subsubsection[{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-scheme (\$ {\em scheme})}}
\label{group__file_ga6b037293e4cfecbabbd8db32191778a5}
Returns a reference to the stream wrapper class responsible for a scheme.

This helper method returns a stream instance using a scheme. That is, the passed string does not contain a \char`\"{}://\char`\"{}. For example, \char`\"{}public\char`\"{} is a scheme but \char`\"{}public://\char`\"{} is a URI (stream). This is because the later contains both a scheme and target despite target being empty.

Note: the instance URI will be initialized to \char`\"{}scheme://\char`\"{} so that you can make the customary method calls as if you had retrieved an instance by URI.


\begin{DoxyParams}{Parameters}
\item[{\em \$scheme}]If the stream was \char`\"{}public://target\char`\"{}, \char`\"{}public\char`\"{} would be the scheme.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a new stream wrapper object appropriate for the given \$scheme. For example, for the public scheme a stream wrapper object (\hyperlink{classDrupalPublicStreamWrapper}{DrupalPublicStreamWrapper}). FALSE is returned if no registered handler could be found. 
\end{DoxyReturn}
\hypertarget{group__file_ga2a693e908e5d4764c56f60b94070a635}{
\index{file@{file}!file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri@{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri}}
\index{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri@{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri}!file@{file}}
\subsubsection[{file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-stream\_\-wrapper\_\-get\_\-instance\_\-by\_\-uri (\$ {\em uri})}}
\label{group__file_ga2a693e908e5d4764c56f60b94070a635}
Returns a reference to the stream wrapper class responsible for a given URI.

The scheme determines the stream wrapper class that should be used by consulting the stream wrapper registry.


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]A stream, referenced as \char`\"{}scheme://target\char`\"{}.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a new stream wrapper object appropriate for the given URI or FALSE if no registered handler could be found. For example, a URI of \char`\"{}private://example.txt\char`\"{} would return a new private stream wrapper object (\hyperlink{classDrupalPrivateStreamWrapper}{DrupalPrivateStreamWrapper}). 
\end{DoxyReturn}
\hypertarget{group__file_gafd9a522999855ed89191e4e58bbbfeb3}{
\index{file@{file}!file\_\-stream\_\-wrapper\_\-uri\_\-normalize@{file\_\-stream\_\-wrapper\_\-uri\_\-normalize}}
\index{file\_\-stream\_\-wrapper\_\-uri\_\-normalize@{file\_\-stream\_\-wrapper\_\-uri\_\-normalize}!file@{file}}
\subsubsection[{file\_\-stream\_\-wrapper\_\-uri\_\-normalize}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-stream\_\-wrapper\_\-uri\_\-normalize (\$ {\em uri})}}
\label{group__file_gafd9a522999855ed89191e4e58bbbfeb3}
Normalizes a URI by making it syntactically correct.

A stream is referenced as \char`\"{}scheme://target\char`\"{}.

The following actions are taken:
\begin{DoxyItemize}
\item Remove trailing slashes from target
\item Trim erroneous leading slashes from target. e.g. \char`\"{}:///\char`\"{} becomes \char`\"{}://\char`\"{}.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]String reference containing the URI to normalize.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The normalized URI. 
\end{DoxyReturn}
\hypertarget{group__file_ga12aebc3c6a9eb56d08511e7b968d0cef}{
\index{file@{file}!file\_\-stream\_\-wrapper\_\-valid\_\-scheme@{file\_\-stream\_\-wrapper\_\-valid\_\-scheme}}
\index{file\_\-stream\_\-wrapper\_\-valid\_\-scheme@{file\_\-stream\_\-wrapper\_\-valid\_\-scheme}!file@{file}}
\subsubsection[{file\_\-stream\_\-wrapper\_\-valid\_\-scheme}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-stream\_\-wrapper\_\-valid\_\-scheme (\$ {\em scheme})}}
\label{group__file_ga12aebc3c6a9eb56d08511e7b968d0cef}
Checks that the scheme of a stream URI is valid.

Confirms that there is a registered stream handler for the provided scheme and that it is callable. This is useful if you want to confirm a valid scheme without creating a new instance of the registered handler.


\begin{DoxyParams}{Parameters}
\item[{\em \$scheme}]A URI scheme, a stream is referenced as \char`\"{}scheme://target\char`\"{}.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns TRUE if the string is the name of a validated stream, or FALSE if the scheme does not have a registered handler. 
\end{DoxyReturn}
\hypertarget{group__file_ga7b047ab67ab5bb3882d573d7e06ab485}{
\index{file@{file}!file\_\-transfer@{file\_\-transfer}}
\index{file\_\-transfer@{file\_\-transfer}!file@{file}}
\subsubsection[{file\_\-transfer}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-transfer (\$ {\em uri}, \/  \$ {\em headers})}}
\label{group__file_ga7b047ab67ab5bb3882d573d7e06ab485}
Transfers a file to the client using HTTP.

Pipes a file through Drupal to the client.


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]String specifying the file URI to transfer. \item[{\em \$headers}]An array of HTTP headers to send along with file. \end{DoxyParams}
\hypertarget{group__file_ga19b0d88682d26b7e5d03cb22ac2af391}{
\index{file@{file}!file\_\-unmanaged\_\-copy@{file\_\-unmanaged\_\-copy}}
\index{file\_\-unmanaged\_\-copy@{file\_\-unmanaged\_\-copy}!file@{file}}
\subsubsection[{file\_\-unmanaged\_\-copy}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-unmanaged\_\-copy (\$ {\em source}, \/  \$ {\em destination} = {\ttfamily NULL}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_ga19b0d88682d26b7e5d03cb22ac2af391}
Copies a file to a new location without invoking the file API.

This is a powerful function that in many ways performs like an advanced version of copy().
\begin{DoxyItemize}
\item Checks if \$source and \$destination are valid and readable/writable.
\item Checks that \$source is not equal to \$destination; if they are an error is reported.
\item If file already exists in \$destination either the call will error out, replace the file or rename the file based on the \$replace parameter.
\item Provides a fallback using realpaths if the move fails using stream wrappers. This can occur because PHP's copy() function does not properly support streams if safe\_\-mode or open\_\-basedir are enabled. See \href{https://bugs.php.net/bug.php?id=60456}{\tt https://bugs.php.net/bug.php?id=60456}
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$source}]A string specifying the filepath or URI of the source file. \item[{\em \$destination}]A URI containing the destination that \$source should be copied to. The URI may be a bare filepath (without a scheme). If this value is omitted, Drupal's default files scheme will be used, usually \char`\"{}public://\char`\"{}. \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The path to the new file, or FALSE in the event of an error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_gae49a2da7203ef43ae7adcf128d58d860}{file\_\-copy()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga336a7e83da1397131e665d1c6e97fc83}{
\index{file@{file}!file\_\-unmanaged\_\-delete@{file\_\-unmanaged\_\-delete}}
\index{file\_\-unmanaged\_\-delete@{file\_\-unmanaged\_\-delete}!file@{file}}
\subsubsection[{file\_\-unmanaged\_\-delete}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-unmanaged\_\-delete (\$ {\em path})}}
\label{group__file_ga336a7e83da1397131e665d1c6e97fc83}
Deletes a file without database changes or hook invocations.

This function should be used when the file to be deleted does not have an entry recorded in the files table.


\begin{DoxyParams}{Parameters}
\item[{\em \$path}]A string containing a file path or (streamwrapper) URI.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE for success or path does not exist, or FALSE in the event of an error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_gac7503f0dcdea965d68e4a242e7760921}{file\_\-delete()} 

\hyperlink{group__file_gaf5c2cffaaf70f0f62a513f033d814899}{file\_\-unmanaged\_\-delete\_\-recursive()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gaf5c2cffaaf70f0f62a513f033d814899}{
\index{file@{file}!file\_\-unmanaged\_\-delete\_\-recursive@{file\_\-unmanaged\_\-delete\_\-recursive}}
\index{file\_\-unmanaged\_\-delete\_\-recursive@{file\_\-unmanaged\_\-delete\_\-recursive}!file@{file}}
\subsubsection[{file\_\-unmanaged\_\-delete\_\-recursive}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-unmanaged\_\-delete\_\-recursive (\$ {\em path})}}
\label{group__file_gaf5c2cffaaf70f0f62a513f033d814899}
Deletes all files and directories in the specified filepath recursively.

If the specified path is a directory then the function will call itself recursively to process the contents. Once the contents have been removed the directory will also be removed.

If the specified path is a file then it will be passed to \hyperlink{group__file_ga336a7e83da1397131e665d1c6e97fc83}{file\_\-unmanaged\_\-delete()}.

Note that this only deletes visible files with write permission.


\begin{DoxyParams}{Parameters}
\item[{\em \$path}]A string containing either an URI or a file or directory path.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE for success or if path does not exist, FALSE in the event of an error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga336a7e83da1397131e665d1c6e97fc83}{file\_\-unmanaged\_\-delete()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga3fd3a919ca321ec8c5bd1e4b069237a1}{
\index{file@{file}!file\_\-unmanaged\_\-move@{file\_\-unmanaged\_\-move}}
\index{file\_\-unmanaged\_\-move@{file\_\-unmanaged\_\-move}!file@{file}}
\subsubsection[{file\_\-unmanaged\_\-move}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-unmanaged\_\-move (\$ {\em source}, \/  \$ {\em destination} = {\ttfamily NULL}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_ga3fd3a919ca321ec8c5bd1e4b069237a1}
Moves a file to a new location without database changes or hook invocation.


\begin{DoxyParams}{Parameters}
\item[{\em \$source}]A string specifying the filepath or URI of the original file. \item[{\em \$destination}]A string containing the destination that \$source should be moved to. This must be a stream wrapper URI. If this value is omitted, Drupal's default files scheme will be used, usually \char`\"{}public://\char`\"{}. \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The URI of the moved file, or FALSE in the event of an error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_gad6f4eec44e0c32bf0cde6c602d5da38f}{file\_\-move()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gac2d047d4471ec93803f584cda01a557c}{
\index{file@{file}!file\_\-unmanaged\_\-save\_\-data@{file\_\-unmanaged\_\-save\_\-data}}
\index{file\_\-unmanaged\_\-save\_\-data@{file\_\-unmanaged\_\-save\_\-data}!file@{file}}
\subsubsection[{file\_\-unmanaged\_\-save\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-unmanaged\_\-save\_\-data (\$ {\em data}, \/  \$ {\em destination} = {\ttfamily NULL}, \/  \$ {\em replace} = {\ttfamily {\bf FILE\_\-EXISTS\_\-RENAME}})}}
\label{group__file_gac2d047d4471ec93803f584cda01a557c}
Saves a string to the specified destination without invoking file API.

This function is identical to \hyperlink{group__file_ga7a01611c7c08b91876d93431207dd9b0}{file\_\-save\_\-data()} except the file will not be saved to the \{file\_\-managed\} table and none of the file\_\-$\ast$ hooks will be called.


\begin{DoxyParams}{Parameters}
\item[{\em \$data}]A string containing the contents of the file. \item[{\em \$destination}]A string containing the destination location. This must be a stream wrapper URI. If no value is provided, a randomized name will be generated and the file will be saved using Drupal's default files scheme, usually \char`\"{}public://\char`\"{}. \item[{\em \$replace}]Replace behavior when the destination file already exists:
\begin{DoxyItemize}
\item FILE\_\-EXISTS\_\-REPLACE -\/ Replace the existing file.
\item FILE\_\-EXISTS\_\-RENAME -\/ Append \_\-\{incrementing number\} until the filename is unique.
\item FILE\_\-EXISTS\_\-ERROR -\/ Do nothing and return FALSE.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string with the path of the resulting file, or FALSE on error.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga7a01611c7c08b91876d93431207dd9b0}{file\_\-save\_\-data()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gabda71018b91068bcd9fcd527a0493347}{
\index{file@{file}!file\_\-unmunge\_\-filename@{file\_\-unmunge\_\-filename}}
\index{file\_\-unmunge\_\-filename@{file\_\-unmunge\_\-filename}!file@{file}}
\subsubsection[{file\_\-unmunge\_\-filename}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-unmunge\_\-filename (\$ {\em filename})}}
\label{group__file_gabda71018b91068bcd9fcd527a0493347}
Undoes the effect of \hyperlink{group__file_gae5f97959982c78dfde2f806757c21368}{file\_\-munge\_\-filename()}.


\begin{DoxyParams}{Parameters}
\item[{\em \$filename}]String with the filename to be unmunged.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An unmunged filename string. 
\end{DoxyReturn}
\hypertarget{group__file_ga7cf25e6a2532a1d022ee1c655f895380}{
\index{file@{file}!file\_\-upload\_\-max\_\-size@{file\_\-upload\_\-max\_\-size}}
\index{file\_\-upload\_\-max\_\-size@{file\_\-upload\_\-max\_\-size}!file@{file}}
\subsubsection[{file\_\-upload\_\-max\_\-size}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-upload\_\-max\_\-size ()}}
\label{group__file_ga7cf25e6a2532a1d022ee1c655f895380}
Determines the maximum file upload size by querying the PHP settings.

\begin{DoxyReturn}{Returns}
A file size limit in bytes based on the PHP upload\_\-max\_\-filesize and post\_\-max\_\-size 
\end{DoxyReturn}
\hypertarget{group__file_gaa98f967fe1033030e7e5262adda85463}{
\index{file@{file}!file\_\-uri\_\-scheme@{file\_\-uri\_\-scheme}}
\index{file\_\-uri\_\-scheme@{file\_\-uri\_\-scheme}!file@{file}}
\subsubsection[{file\_\-uri\_\-scheme}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-uri\_\-scheme (\$ {\em uri})}}
\label{group__file_gaa98f967fe1033030e7e5262adda85463}
Returns the scheme of a URI (e.g. a stream).


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]A stream, referenced as \char`\"{}scheme://target\char`\"{}.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string containing the name of the scheme, or FALSE if none. For example, the URI \char`\"{}public://example.txt\char`\"{} would return \char`\"{}public\char`\"{}.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga3137c530a505bcbaaeff3c4265f3f662}{file\_\-uri\_\-target()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga3137c530a505bcbaaeff3c4265f3f662}{
\index{file@{file}!file\_\-uri\_\-target@{file\_\-uri\_\-target}}
\index{file\_\-uri\_\-target@{file\_\-uri\_\-target}!file@{file}}
\subsubsection[{file\_\-uri\_\-target}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-uri\_\-target (\$ {\em uri})}}
\label{group__file_ga3137c530a505bcbaaeff3c4265f3f662}
Returns the part of a URI after the schema.


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]A stream, referenced as \char`\"{}scheme://target\char`\"{}.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string containing the target (path), or FALSE if none. For example, the URI \char`\"{}public://sample/test.txt\char`\"{} would return \char`\"{}sample/test.txt\char`\"{}.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_gaa98f967fe1033030e7e5262adda85463}{file\_\-uri\_\-scheme()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga41a98960234fa8f802cfc1c4c769ae05}{
\index{file@{file}!file\_\-usage\_\-add@{file\_\-usage\_\-add}}
\index{file\_\-usage\_\-add@{file\_\-usage\_\-add}!file@{file}}
\subsubsection[{file\_\-usage\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-usage\_\-add (stdClass \$ {\em file}, \/  \$ {\em module}, \/  \$ {\em type}, \/  \$ {\em id}, \/  \$ {\em count} = {\ttfamily 1})}}
\label{group__file_ga41a98960234fa8f802cfc1c4c769ae05}
Records that a module is using a file.

This usage information will be queried during \hyperlink{group__file_gac7503f0dcdea965d68e4a242e7760921}{file\_\-delete()} to ensure that a file is not in use before it is physically removed from disk.

Examples:
\begin{DoxyItemize}
\item A module that associates files with nodes, so \$type would be 'node' and \$id would be the node's nid. Files for all revisions are stored within a single nid.
\item The User module associates an image with a user, so \$type would be 'user' and the \$id would be the user's uid.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object. \item[{\em \$module}]The name of the module using the file. \item[{\em \$type}]The type of the object that contains the referenced file. \item[{\em \$id}]The unique, numeric ID of the object containing the referenced file. \item[{\em \$count}](optional) The number of references to add to the object. Defaults to 1.\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga6399c4096559ffbe81cfcb22db782bc4}{file\_\-usage\_\-list()} 

\hyperlink{group__file_gaf8562c4494373ec51079bb0999a8ae3a}{file\_\-usage\_\-delete()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gaf8562c4494373ec51079bb0999a8ae3a}{
\index{file@{file}!file\_\-usage\_\-delete@{file\_\-usage\_\-delete}}
\index{file\_\-usage\_\-delete@{file\_\-usage\_\-delete}!file@{file}}
\subsubsection[{file\_\-usage\_\-delete}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-usage\_\-delete (stdClass \$ {\em file}, \/  \$ {\em module}, \/  \$ {\em type} = {\ttfamily NULL}, \/  \$ {\em id} = {\ttfamily NULL}, \/  \$ {\em count} = {\ttfamily 1})}}
\label{group__file_gaf8562c4494373ec51079bb0999a8ae3a}
Removes a record to indicate that a module is no longer using a file.

The \hyperlink{group__file_gac7503f0dcdea965d68e4a242e7760921}{file\_\-delete()} function is typically called after removing a file usage to remove the record from the file\_\-managed table and delete the file itself.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object. \item[{\em \$module}]The name of the module using the file. \item[{\em \$type}](optional) The type of the object that contains the referenced file. May be omitted if all module references to a file are being deleted. \item[{\em \$id}](optional) The unique, numeric ID of the object containing the referenced file. May be omitted if all module references to a file are being deleted. \item[{\em \$count}](optional) The number of references to delete from the object. Defaults to 1. 0 may be specified to delete all references to the file within a specific object.\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga41a98960234fa8f802cfc1c4c769ae05}{file\_\-usage\_\-add()} 

\hyperlink{group__file_ga6399c4096559ffbe81cfcb22db782bc4}{file\_\-usage\_\-list()} 

\hyperlink{group__file_gac7503f0dcdea965d68e4a242e7760921}{file\_\-delete()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga6399c4096559ffbe81cfcb22db782bc4}{
\index{file@{file}!file\_\-usage\_\-list@{file\_\-usage\_\-list}}
\index{file\_\-usage\_\-list@{file\_\-usage\_\-list}!file@{file}}
\subsubsection[{file\_\-usage\_\-list}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-usage\_\-list (stdClass \$ {\em file})}}
\label{group__file_ga6399c4096559ffbe81cfcb22db782bc4}
Determines where a file is used.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A file object.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A nested array with usage data. The first level is keyed by module name, the second by object type and the third by the object id. The value of the third level contains the usage count.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__file_ga41a98960234fa8f802cfc1c4c769ae05}{file\_\-usage\_\-add()} 

\hyperlink{group__file_gaf8562c4494373ec51079bb0999a8ae3a}{file\_\-usage\_\-delete()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gad84d226f677dd5b6e53519026b7de67e}{
\index{file@{file}!file\_\-valid\_\-uri@{file\_\-valid\_\-uri}}
\index{file\_\-valid\_\-uri@{file\_\-valid\_\-uri}!file@{file}}
\subsubsection[{file\_\-valid\_\-uri}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-valid\_\-uri (\$ {\em uri})}}
\label{group__file_gad84d226f677dd5b6e53519026b7de67e}
Determines whether the URI has a valid scheme for file API operations.

There must be a scheme and it must be a Drupal-\/provided scheme like 'public', 'private', 'temporary', or an extension provided with \hyperlink{group__hooks_ga6fadcf625a4766e7f0d97b1628b294dc}{hook\_\-stream\_\-wrappers()}.


\begin{DoxyParams}{Parameters}
\item[{\em \$uri}]The URI to be tested.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE if the URI is allowed. 
\end{DoxyReturn}
\hypertarget{group__file_ga9edf58fdc552d61247bbf8322c434abf}{
\index{file@{file}!file\_\-validate@{file\_\-validate}}
\index{file\_\-validate@{file\_\-validate}!file@{file}}
\subsubsection[{file\_\-validate}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-validate (stdClass \&\$ {\em file}, \/  \$ {\em validators} = {\ttfamily array()})}}
\label{group__file_ga9edf58fdc552d61247bbf8322c434abf}
Checks that a file meets the criteria specified by the validators.

After executing the validator callbacks specified \hyperlink{group__hooks_gab1491b52a117229913448d787156e013}{hook\_\-file\_\-validate()} will also be called to allow other modules to report errors about the file.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A Drupal file object. \item[{\em \$validators}]An optional, associative array of callback functions used to validate the file. The keys are function names and the values arrays of callback parameters which will be passed in after the file object. The functions should return an array of error messages; an empty array indicates that the file passed validation. The functions will be called in the order specified.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array containing validation error messages.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_gab1491b52a117229913448d787156e013}{hook\_\-file\_\-validate()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga4036c6b78f904e5dd0273cf75eb474bb}{
\index{file@{file}!file\_\-validate\_\-extensions@{file\_\-validate\_\-extensions}}
\index{file\_\-validate\_\-extensions@{file\_\-validate\_\-extensions}!file@{file}}
\subsubsection[{file\_\-validate\_\-extensions}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-validate\_\-extensions (stdClass \$ {\em file}, \/  \$ {\em extensions})}}
\label{group__file_ga4036c6b78f904e5dd0273cf75eb474bb}
Checks that the filename ends with an allowed extension.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A Drupal file object. \item[{\em \$extensions}]A string with a space separated list of allowed extensions.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array. If the file extension is not allowed, it will contain an error message.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_gab1491b52a117229913448d787156e013}{hook\_\-file\_\-validate()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gaa90145fbf8065f644871c9d770e3cce4}{
\index{file@{file}!file\_\-validate\_\-image\_\-resolution@{file\_\-validate\_\-image\_\-resolution}}
\index{file\_\-validate\_\-image\_\-resolution@{file\_\-validate\_\-image\_\-resolution}!file@{file}}
\subsubsection[{file\_\-validate\_\-image\_\-resolution}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-validate\_\-image\_\-resolution (stdClass \$ {\em file}, \/  \$ {\em maximum\_\-dimensions} = {\ttfamily 0}, \/  \$ {\em minimum\_\-dimensions} = {\ttfamily 0})}}
\label{group__file_gaa90145fbf8065f644871c9d770e3cce4}
Verifies that image dimensions are within the specified maximum and minimum.

Non-\/image files will be ignored. If a image toolkit is available the image will be scaled to fit within the desired maximum dimensions.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A Drupal file object. This function may resize the file affecting its size. \item[{\em \$maximum\_\-dimensions}]An optional string in the form WIDTHxHEIGHT e.g. '640x480' or '85x85'. If an image toolkit is installed the image will be resized down to these dimensions. A value of 0 indicates no restriction on size, so resizing will be attempted. \item[{\em \$minimum\_\-dimensions}]An optional string in the form WIDTHxHEIGHT. This will check that the image meets a minimum size. A value of 0 indicates no restriction.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array. If the file is an image and did not meet the requirements, it will contain an error message.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_gab1491b52a117229913448d787156e013}{hook\_\-file\_\-validate()} 
\end{DoxySeeAlso}
\hypertarget{group__file_ga4cf6d97afe1580b23a14d96fede02d01}{
\index{file@{file}!file\_\-validate\_\-is\_\-image@{file\_\-validate\_\-is\_\-image}}
\index{file\_\-validate\_\-is\_\-image@{file\_\-validate\_\-is\_\-image}!file@{file}}
\subsubsection[{file\_\-validate\_\-is\_\-image}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-validate\_\-is\_\-image (stdClass \$ {\em file})}}
\label{group__file_ga4cf6d97afe1580b23a14d96fede02d01}
Checks that the file is recognized by \hyperlink{group__image_ga7b2603b2b9d073cc4db9a6200aa9c2a4}{image\_\-get\_\-info()} as an image.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A Drupal file object.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array. If the file is not an image, it will contain an error message.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_gab1491b52a117229913448d787156e013}{hook\_\-file\_\-validate()} 
\end{DoxySeeAlso}
\hypertarget{group__file_gaca56a55a4d3ee635cddf38903c1ed367}{
\index{file@{file}!file\_\-validate\_\-name\_\-length@{file\_\-validate\_\-name\_\-length}}
\index{file\_\-validate\_\-name\_\-length@{file\_\-validate\_\-name\_\-length}!file@{file}}
\subsubsection[{file\_\-validate\_\-name\_\-length}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-validate\_\-name\_\-length (stdClass \$ {\em file})}}
\label{group__file_gaca56a55a4d3ee635cddf38903c1ed367}
Checks for files with names longer than we can store in the database.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A Drupal file object.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array. If the file name is too long, it will contain an error message. 
\end{DoxyReturn}
\hypertarget{group__file_gad5dc623436b94f82d7a110adf8590915}{
\index{file@{file}!file\_\-validate\_\-size@{file\_\-validate\_\-size}}
\index{file\_\-validate\_\-size@{file\_\-validate\_\-size}!file@{file}}
\subsubsection[{file\_\-validate\_\-size}]{\setlength{\rightskip}{0pt plus 5cm}file\_\-validate\_\-size (stdClass \$ {\em file}, \/  \$ {\em file\_\-limit} = {\ttfamily 0}, \/  \$ {\em user\_\-limit} = {\ttfamily 0})}}
\label{group__file_gad5dc623436b94f82d7a110adf8590915}
Checks that the file's size is below certain limits.

This check is not enforced for the user \#1.


\begin{DoxyParams}{Parameters}
\item[{\em \$file}]A Drupal file object. \item[{\em \$file\_\-limit}]An integer specifying the maximum file size in bytes. Zero indicates that no limit should be enforced. \item[{\em \$user\_\-limit}]An integer specifying the maximum number of bytes the user is allowed. Zero indicates that no limit should be enforced.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array. If the file size exceeds limits, it will contain an error message.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_gab1491b52a117229913448d787156e013}{hook\_\-file\_\-validate()} 
\end{DoxySeeAlso}
