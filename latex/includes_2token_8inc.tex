\hypertarget{includes_2token_8inc}{
\section{html/includes/token.inc File Reference}
\label{includes_2token_8inc}\index{html/includes/token.inc@{html/includes/token.inc}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{includes_2token_8inc_a47eb294b05ca8d04439a9a82ccc4d82a}{token\_\-replace} (\$text, array \$data=array(), array \$options=array())
\item 
\hyperlink{includes_2token_8inc_a0672a1031161b81dd5aff4476bbc1c99}{token\_\-scan} (\$text)
\item 
\hyperlink{includes_2token_8inc_abcd5ba5a75b47fe97338243a62d4eecd}{token\_\-generate} (\$type, array \$tokens, array \$data=array(), array \$options=array())
\item 
\hyperlink{includes_2token_8inc_ae6241ad02cf636533b0a8304d2df4c1b}{token\_\-find\_\-with\_\-prefix} (array \$tokens, \$prefix, \$delimiter= ':')
\item 
\hyperlink{includes_2token_8inc_a24f0543f20ed0c8b807a680e67248704}{token\_\-info} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Drupal placeholder/token replacement system.

API functions for replacing placeholders in text with meaningful values.

For example: When configuring automated emails, an administrator enters standard text for the email. Variables like the title of a node and the date the email was sent can be entered as placeholders like \mbox{[}node:title\mbox{]} and \mbox{[}date:short\mbox{]}. When a Drupal module prepares to send the email, it can call the \hyperlink{includes_2token_8inc_a47eb294b05ca8d04439a9a82ccc4d82a}{token\_\-replace()} function, passing in the text. The token system will scan the text for placeholder tokens, give other modules an opportunity to replace them with meaningful text, then return the final product to the original module.

Tokens follow the form: \mbox{[}\$type:\$name\mbox{]}, where \$type is a general class of tokens like 'node', 'user', or 'comment' and \$name is the name of a given placeholder. For example, \mbox{[}node:title\mbox{]} or \mbox{[}node:created:since\mbox{]}.

In addition to raw text containing placeholders, modules may pass in an array of objects to be used when performing the replacement. The objects should be keyed by the token type they correspond to. For example:


\begin{DoxyCode}
 // Load a node and a user, then replace tokens in the text.
 $text = 'On [date:short], [user:name] read [node:title].';
 $node = node_load(1);
 $user = user_load(1);

 // [date:...] tokens use the current date automatically.
 $data = array('node' => $node, 'user' => $user);
 return token_replace($text, $data);
\end{DoxyCode}


Some tokens may be chained in the form of \mbox{[}\$type:\$pointer:\$name\mbox{]}, where \$type is a normal token type, \$pointer is a reference to another token type, and \$name is the name of a given placeholder. For example, \mbox{[}node:author:mail\mbox{]}. In that example, 'author' is a pointer to the 'user' account that created the node, and 'mail' is a placeholder available for any 'user'.

\begin{DoxySeeAlso}{See also}
\hyperlink{includes_2token_8inc_a47eb294b05ca8d04439a9a82ccc4d82a}{token\_\-replace()} 

\hyperlink{group__hooks_ga3bfd87d9a19b2397b0f970e1cff7ea4f}{hook\_\-tokens()} 

\hyperlink{group__hooks_gab868597197cf36911f95dcd29ae0b954}{hook\_\-token\_\-info()} 
\end{DoxySeeAlso}


\subsection{Function Documentation}
\hypertarget{includes_2token_8inc_ae6241ad02cf636533b0a8304d2df4c1b}{
\index{includes/token.inc@{includes/token.inc}!token\_\-find\_\-with\_\-prefix@{token\_\-find\_\-with\_\-prefix}}
\index{token\_\-find\_\-with\_\-prefix@{token\_\-find\_\-with\_\-prefix}!includes/token.inc@{includes/token.inc}}
\subsubsection[{token\_\-find\_\-with\_\-prefix}]{\setlength{\rightskip}{0pt plus 5cm}token\_\-find\_\-with\_\-prefix (array \$ {\em tokens}, \/  \$ {\em prefix}, \/  \$ {\em delimiter} = {\ttfamily ':'})}}
\label{includes_2token_8inc_ae6241ad02cf636533b0a8304d2df4c1b}
Returns a list of tokens that begin with a specific prefix.

Used to extract a group of 'chained' tokens (such as \mbox{[}node:author:name\mbox{]}) from the full list of tokens found in text. For example: 
\begin{DoxyCode}
   $data = array(
     'author:name' => '[node:author:name]',
     'title'       => '[node:title]',
     'created'     => '[node:created]',
   );
   $results = token_find_with_prefix($data, 'author');
   $results == array('name' => '[node:author:name]');
\end{DoxyCode}



\begin{DoxyParams}{Parameters}
\item[{\em \$tokens}]A keyed array of tokens, and their original raw form in the source text. \item[{\em \$prefix}]A textual string to be matched at the beginning of the token. \item[{\em \$delimiter}]An optional string containing the character that separates the prefix from the rest of the token. Defaults to ':'.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An associative array of discovered tokens, with the prefix and delimiter stripped from the key. 
\end{DoxyReturn}
\hypertarget{includes_2token_8inc_abcd5ba5a75b47fe97338243a62d4eecd}{
\index{includes/token.inc@{includes/token.inc}!token\_\-generate@{token\_\-generate}}
\index{token\_\-generate@{token\_\-generate}!includes/token.inc@{includes/token.inc}}
\subsubsection[{token\_\-generate}]{\setlength{\rightskip}{0pt plus 5cm}token\_\-generate (\$ {\em type}, \/  array \$ {\em tokens}, \/  array \$ {\em data} = {\ttfamily array()}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{includes_2token_8inc_abcd5ba5a75b47fe97338243a62d4eecd}
Generates replacement values for a list of tokens.


\begin{DoxyParams}{Parameters}
\item[{\em \$type}]The type of token being replaced. 'node', 'user', and 'date' are common. \item[{\em \$tokens}]An array of tokens to be replaced, keyed by the literal text of the token as it appeared in the source text. \item[{\em \$data}](optional) An array of keyed objects. For simple replacement scenarios 'node', 'user', and others are common keys, with an accompanying node or user object being the value. Some token types, like 'site', do not require any explicit information from \$data and can be replaced even if it is empty. \item[{\em \$options}](optional) A keyed array of settings and flags to control the token replacement process. Supported options are:
\begin{DoxyItemize}
\item language: A language object to be used when generating locale-\/sensitive tokens.
\item callback: A callback function that will be used to post-\/process the array of token replacements after they are generated. Can be used when modules require special formatting of token text, for example URL encoding or truncation to a specific length.
\item sanitize: A boolean flag indicating that tokens should be sanitized for display to a web browser. Developers who set this option to FALSE assume responsibility for running \hyperlink{group__sanitization_ga8864a29ffa8de5c9f8dc9e417060660d}{filter\_\-xss()}, \hyperlink{group__sanitization_ga76fc67a30fd8d75ddd80565e6e65a13d}{check\_\-plain()} or other appropriate scrubbing functions before displaying data to users.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An associative array of replacement values, keyed by the original 'raw' tokens that were found in the source text. For example: \$results\mbox{[}'\mbox{[}node:title\mbox{]}'\mbox{]} = 'My new node';
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__hooks_ga3bfd87d9a19b2397b0f970e1cff7ea4f}{hook\_\-tokens()} 

\hyperlink{group__hooks_gaeeea438e74b29e5603f0ed3f1967a257}{hook\_\-tokens\_\-alter()} 
\end{DoxySeeAlso}
\hypertarget{includes_2token_8inc_a24f0543f20ed0c8b807a680e67248704}{
\index{includes/token.inc@{includes/token.inc}!token\_\-info@{token\_\-info}}
\index{token\_\-info@{token\_\-info}!includes/token.inc@{includes/token.inc}}
\subsubsection[{token\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}token\_\-info ()}}
\label{includes_2token_8inc_a24f0543f20ed0c8b807a680e67248704}
Returns metadata describing supported tokens.

The metadata array contains token type, name, and description data as well as an optional pointer indicating that the token chains to another set of tokens.

For example: 
\begin{DoxyCode}
   $data['types']['node'] = array(
     'name' => t('Nodes'),
     'description' => t('Tokens related to node objects.'),
   );
   $data['tokens']['node']['title'] = array(
     'name' => t('Title'),
     'description' => t('The title of the current node.'),
   );
   $data['tokens']['node']['author'] = array(
     'name' => t('Author'),
     'description' => t('The author of the current node.'),
     'type' => 'user',
   );
\end{DoxyCode}


\begin{DoxyReturn}{Returns}
An associative array of token information, grouped by token type. 
\end{DoxyReturn}
\hypertarget{includes_2token_8inc_a47eb294b05ca8d04439a9a82ccc4d82a}{
\index{includes/token.inc@{includes/token.inc}!token\_\-replace@{token\_\-replace}}
\index{token\_\-replace@{token\_\-replace}!includes/token.inc@{includes/token.inc}}
\subsubsection[{token\_\-replace}]{\setlength{\rightskip}{0pt plus 5cm}token\_\-replace (\$ {\em text}, \/  array \$ {\em data} = {\ttfamily array()}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{includes_2token_8inc_a47eb294b05ca8d04439a9a82ccc4d82a}
Replaces all tokens in a given string with appropriate values.


\begin{DoxyParams}{Parameters}
\item[{\em \$text}]A string potentially containing replaceable tokens. \item[{\em \$data}](optional) An array of keyed objects. For simple replacement scenarios 'node', 'user', and others are common keys, with an accompanying node or user object being the value. Some token types, like 'site', do not require any explicit information from \$data and can be replaced even if it is empty. \item[{\em \$options}](optional) A keyed array of settings and flags to control the token replacement process. Supported options are:
\begin{DoxyItemize}
\item language: A language object to be used when generating locale-\/sensitive tokens.
\item callback: A callback function that will be used to post-\/process the array of token replacements after they are generated. For example, a module using tokens in a text-\/only email might provide a callback to strip HTML entities from token values before they are inserted into the final text.
\item clear: A boolean flag indicating that tokens should be removed from the final text if no replacement value can be generated.
\item sanitize: A boolean flag indicating that tokens should be sanitized for display to a web browser. Defaults to TRUE. Developers who set this option to FALSE assume responsibility for running \hyperlink{group__sanitization_ga8864a29ffa8de5c9f8dc9e417060660d}{filter\_\-xss()}, \hyperlink{group__sanitization_ga76fc67a30fd8d75ddd80565e6e65a13d}{check\_\-plain()} or other appropriate scrubbing functions before displaying data to users.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Text with tokens replaced. 
\end{DoxyReturn}
\hypertarget{includes_2token_8inc_a0672a1031161b81dd5aff4476bbc1c99}{
\index{includes/token.inc@{includes/token.inc}!token\_\-scan@{token\_\-scan}}
\index{token\_\-scan@{token\_\-scan}!includes/token.inc@{includes/token.inc}}
\subsubsection[{token\_\-scan}]{\setlength{\rightskip}{0pt plus 5cm}token\_\-scan (\$ {\em text})}}
\label{includes_2token_8inc_a0672a1031161b81dd5aff4476bbc1c99}
Builds a list of all token-\/like patterns that appear in the text.


\begin{DoxyParams}{Parameters}
\item[{\em \$text}]The text to be scanned for possible tokens.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An associative array of discovered tokens, grouped by type. 
\end{DoxyReturn}
