\hypertarget{date__repeat__calc_8inc}{
\section{html/profiles/dosomething/modules/contrib/date/date\_\-repeat/date\_\-repeat\_\-calc.inc File Reference}
\label{date__repeat__calc_8inc}\index{html/profiles/dosomething/modules/contrib/date/date\_\-repeat/date\_\-repeat\_\-calc.inc@{html/profiles/dosomething/modules/contrib/date/date\_\-repeat/date\_\-repeat\_\-calc.inc}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{date__repeat__calc_8inc_ad796c923ad9e24f33935e46db723e0d5}{\_\-date\_\-repeat\_\-calc} (\$rrule, \$start, \$end, \$exceptions, \$timezone, \$additions)
\item 
\hyperlink{date__repeat__calc_8inc_ac7db442bbe826375c43885aea6f2ab97}{date\_\-repeat\_\-adjust\_\-rrule} (\$rrule, \$start\_\-date)
\item 
\hyperlink{date__repeat__calc_8inc_a046e6888825942f799c920fd836ac093}{date\_\-repeat\_\-add\_\-dates} (\&\$days, \$current\_\-day, \$start\_\-date, \$end\_\-date, \$exceptions, \$rrule)
\item 
\hyperlink{date__repeat__calc_8inc_ab88ff1562600418b74f2063c257a33b4}{date\_\-repeat\_\-is\_\-finished} (\$current\_\-day, \$days, \$count, \$end\_\-date)
\item 
\hyperlink{date__repeat__calc_8inc_a77b30690f7f9b9caab51f3dc4c652aa9}{date\_\-repeat\_\-set\_\-month\_\-day} (\$date\_\-in, \$day, \$count=1, \$direction= '+', \$timezone= 'UTC', \$modify\_\-time)
\item 
\hyperlink{date__repeat__calc_8inc_a2feae22de131cda2a56cacbacd5c5dc0}{date\_\-repeat\_\-set\_\-year\_\-day} (\$date\_\-in, \$day, \$count=1, \$direction= '+', \$timezone= 'UTC', \$modify\_\-time)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Code to compute the dates that match an iCal RRULE.

Moved to a separate file since it is not used on most pages so the code is not parsed unless needed.

Extensive simpletests have been created to test the RRULE calculation results against official examples from RFC 2445.

These calculations are expensive and results should be stored or cached so the calculation code is not called more often than necessary.

Currently implemented: INTERVAL, UNTIL, COUNT, EXDATE, RDATE, BYDAY, BYMONTHDAY, BYMONTH, YEARLY, MONTHLY, WEEKLY, DAILY

Currently not implemented:

BYYEARDAY, MINUTELY, HOURLY, SECONDLY, BYMINUTE, BYHOUR, BYSECOND These could be implemented in the future.

BYSETPOS Seldom used anywhere, so no reason to complicated the code. 

\subsection{Function Documentation}
\hypertarget{date__repeat__calc_8inc_ad796c923ad9e24f33935e46db723e0d5}{
\index{date\_\-repeat\_\-calc.inc@{date\_\-repeat\_\-calc.inc}!\_\-date\_\-repeat\_\-calc@{\_\-date\_\-repeat\_\-calc}}
\index{\_\-date\_\-repeat\_\-calc@{\_\-date\_\-repeat\_\-calc}!date_repeat_calc.inc@{date\_\-repeat\_\-calc.inc}}
\subsubsection[{\_\-date\_\-repeat\_\-calc}]{\setlength{\rightskip}{0pt plus 5cm}\_\-date\_\-repeat\_\-calc (\$ {\em rrule}, \/  \$ {\em start}, \/  \$ {\em end}, \/  \$ {\em exceptions}, \/  \$ {\em timezone}, \/  \$ {\em additions})}}
\label{date__repeat__calc_8inc_ad796c923ad9e24f33935e46db723e0d5}
Private implementation of \hyperlink{date__repeat_8module_a3d79ef2b99159e6f7bf47560e0fd40f9}{date\_\-repeat\_\-calc()}.

Compute dates that match the requested rule, within a specified date range. \hypertarget{date__repeat__calc_8inc_a046e6888825942f799c920fd836ac093}{
\index{date\_\-repeat\_\-calc.inc@{date\_\-repeat\_\-calc.inc}!date\_\-repeat\_\-add\_\-dates@{date\_\-repeat\_\-add\_\-dates}}
\index{date\_\-repeat\_\-add\_\-dates@{date\_\-repeat\_\-add\_\-dates}!date_repeat_calc.inc@{date\_\-repeat\_\-calc.inc}}
\subsubsection[{date\_\-repeat\_\-add\_\-dates}]{\setlength{\rightskip}{0pt plus 5cm}date\_\-repeat\_\-add\_\-dates (\&\$ {\em days}, \/  \$ {\em current\_\-day}, \/  \$ {\em start\_\-date}, \/  \$ {\em end\_\-date}, \/  \$ {\em exceptions}, \/  \$ {\em rrule})}}
\label{date__repeat__calc_8inc_a046e6888825942f799c920fd836ac093}
Helper function to add found date to the \$dates array.

Check that the date to be added is between the start and end date and that it is not in the \$exceptions, nor already in the \$days array, and that it meets other criteria in the RRULE. \hypertarget{date__repeat__calc_8inc_ac7db442bbe826375c43885aea6f2ab97}{
\index{date\_\-repeat\_\-calc.inc@{date\_\-repeat\_\-calc.inc}!date\_\-repeat\_\-adjust\_\-rrule@{date\_\-repeat\_\-adjust\_\-rrule}}
\index{date\_\-repeat\_\-adjust\_\-rrule@{date\_\-repeat\_\-adjust\_\-rrule}!date_repeat_calc.inc@{date\_\-repeat\_\-calc.inc}}
\subsubsection[{date\_\-repeat\_\-adjust\_\-rrule}]{\setlength{\rightskip}{0pt plus 5cm}date\_\-repeat\_\-adjust\_\-rrule (\$ {\em rrule}, \/  \$ {\em start\_\-date})}}
\label{date__repeat__calc_8inc_ac7db442bbe826375c43885aea6f2ab97}
See if the RRULE needs some imputed values added to it. \hypertarget{date__repeat__calc_8inc_ab88ff1562600418b74f2063c257a33b4}{
\index{date\_\-repeat\_\-calc.inc@{date\_\-repeat\_\-calc.inc}!date\_\-repeat\_\-is\_\-finished@{date\_\-repeat\_\-is\_\-finished}}
\index{date\_\-repeat\_\-is\_\-finished@{date\_\-repeat\_\-is\_\-finished}!date_repeat_calc.inc@{date\_\-repeat\_\-calc.inc}}
\subsubsection[{date\_\-repeat\_\-is\_\-finished}]{\setlength{\rightskip}{0pt plus 5cm}date\_\-repeat\_\-is\_\-finished (\$ {\em current\_\-day}, \/  \$ {\em days}, \/  \$ {\em count}, \/  \$ {\em end\_\-date})}}
\label{date__repeat__calc_8inc_ab88ff1562600418b74f2063c257a33b4}
Stop when \$current\_\-day is greater than \$end\_\-date or \$count is reached. \hypertarget{date__repeat__calc_8inc_a77b30690f7f9b9caab51f3dc4c652aa9}{
\index{date\_\-repeat\_\-calc.inc@{date\_\-repeat\_\-calc.inc}!date\_\-repeat\_\-set\_\-month\_\-day@{date\_\-repeat\_\-set\_\-month\_\-day}}
\index{date\_\-repeat\_\-set\_\-month\_\-day@{date\_\-repeat\_\-set\_\-month\_\-day}!date_repeat_calc.inc@{date\_\-repeat\_\-calc.inc}}
\subsubsection[{date\_\-repeat\_\-set\_\-month\_\-day}]{\setlength{\rightskip}{0pt plus 5cm}date\_\-repeat\_\-set\_\-month\_\-day (\$ {\em date\_\-in}, \/  \$ {\em day}, \/  \$ {\em count} = {\ttfamily 1}, \/  \$ {\em direction} = {\ttfamily '+'}, \/  \$ {\em timezone} = {\ttfamily 'UTC'}, \/  \$ {\em modify\_\-time})}}
\label{date__repeat__calc_8inc_a77b30690f7f9b9caab51f3dc4c652aa9}
Set a date object to a specific day of the month.

Example, date\_\-set\_\-month\_\-day(\$date, 'Sunday', 2, '-\/') will reset \$date to the second to last Sunday in the month. If \$day is empty, will set to the number of days from the beginning or end of the month. \hypertarget{date__repeat__calc_8inc_a2feae22de131cda2a56cacbacd5c5dc0}{
\index{date\_\-repeat\_\-calc.inc@{date\_\-repeat\_\-calc.inc}!date\_\-repeat\_\-set\_\-year\_\-day@{date\_\-repeat\_\-set\_\-year\_\-day}}
\index{date\_\-repeat\_\-set\_\-year\_\-day@{date\_\-repeat\_\-set\_\-year\_\-day}!date_repeat_calc.inc@{date\_\-repeat\_\-calc.inc}}
\subsubsection[{date\_\-repeat\_\-set\_\-year\_\-day}]{\setlength{\rightskip}{0pt plus 5cm}date\_\-repeat\_\-set\_\-year\_\-day (\$ {\em date\_\-in}, \/  \$ {\em day}, \/  \$ {\em count} = {\ttfamily 1}, \/  \$ {\em direction} = {\ttfamily '+'}, \/  \$ {\em timezone} = {\ttfamily 'UTC'}, \/  \$ {\em modify\_\-time})}}
\label{date__repeat__calc_8inc_a2feae22de131cda2a56cacbacd5c5dc0}
Set a date object to a specific day of the year.

Example, date\_\-set\_\-year\_\-day(\$date, 'Sunday', 2, '-\/') will reset \$date to the second to last Sunday in the year. If \$day is empty, will set to the number of days from the beginning or end of the year. 