\hypertarget{password_8inc}{
\section{html/includes/password.inc File Reference}
\label{password_8inc}\index{html/includes/password.inc@{html/includes/password.inc}}
}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{password_8inc_a6779dd88da34773d5f1b68cd3176fd2f}{DRUPAL\_\-HASH\_\-COUNT} 
\item 
enum \hyperlink{password_8inc_ab26271966114a05b9ccb6287c4848309}{DRUPAL\_\-MIN\_\-HASH\_\-COUNT} 
\item 
enum \hyperlink{password_8inc_aa0eb61e6083023579b85b387475b529f}{DRUPAL\_\-MAX\_\-HASH\_\-COUNT} 
\item 
enum \hyperlink{password_8inc_aeb9d94dcc991ed40a124d8ff153d2782}{DRUPAL\_\-HASH\_\-LENGTH} 
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{password_8inc_acfa07cc7bbe581412346fcc7ec03cda3}{\_\-password\_\-itoa64} ()
\item 
\hyperlink{password_8inc_ab987820d3546d9284a976236fa42fa59}{\_\-password\_\-base64\_\-encode} (\$input, \$count)
\item 
\hyperlink{password_8inc_a0ebe31e5a38758a91dfd23d98f2b719a}{\_\-password\_\-generate\_\-salt} (\$count\_\-log2)
\item 
\hyperlink{password_8inc_a65b1a9f521b456c95ec8f8542bd5f59b}{\_\-password\_\-enforce\_\-log2\_\-boundaries} (\$count\_\-log2)
\item 
\hyperlink{password_8inc_a857b6008d6928c55df3823524d5c30d2}{\_\-password\_\-crypt} (\$algo, \$password, \$setting)
\item 
\hyperlink{password_8inc_a9af4ef28bcef6a4f53e9eed9735848b5}{\_\-password\_\-get\_\-count\_\-log2} (\$setting)
\item 
\hyperlink{password_8inc_a7fa51cbbe5dd15f39953097ea25eb237}{user\_\-hash\_\-password} (\$password, \$count\_\-log2=0)
\item 
\hyperlink{password_8inc_a8fca5fd75cd7a3c609e21a48ef087868}{user\_\-check\_\-password} (\$password, \$account)
\item 
\hyperlink{password_8inc_a5c5ff8dd0c7fb7880535bacd445a5574}{user\_\-needs\_\-new\_\-hash} (\$account)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Secure password hashing functions for user authentication.

Based on the Portable PHP password hashing framework. \begin{DoxySeeAlso}{See also}
\href{http://www.openwall.com/phpass/}{\tt http://www.openwall.com/phpass/}
\end{DoxySeeAlso}
An alternative or custom version of this password hashing API may be used by setting the variable password\_\-inc to the name of the PHP file containing replacement \hyperlink{password_8inc_a7fa51cbbe5dd15f39953097ea25eb237}{user\_\-hash\_\-password()}, \hyperlink{password_8inc_a8fca5fd75cd7a3c609e21a48ef087868}{user\_\-check\_\-password()}, and \hyperlink{password_8inc_a5c5ff8dd0c7fb7880535bacd445a5574}{user\_\-needs\_\-new\_\-hash()} functions. 

\subsection{Enumeration Type Documentation}
\hypertarget{password_8inc_a6779dd88da34773d5f1b68cd3176fd2f}{
\index{password.inc@{password.inc}!DRUPAL\_\-HASH\_\-COUNT@{DRUPAL\_\-HASH\_\-COUNT}}
\index{DRUPAL\_\-HASH\_\-COUNT@{DRUPAL\_\-HASH\_\-COUNT}!password.inc@{password.inc}}
\subsubsection[{DRUPAL\_\-HASH\_\-COUNT}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf DRUPAL\_\-HASH\_\-COUNT}}}
\label{password_8inc_a6779dd88da34773d5f1b68cd3176fd2f}
The standard log2 number of iterations for password stretching. This should increase by 1 every Drupal version in order to counteract increases in the speed and power of computers available to crack the hashes. \hypertarget{password_8inc_aeb9d94dcc991ed40a124d8ff153d2782}{
\index{password.inc@{password.inc}!DRUPAL\_\-HASH\_\-LENGTH@{DRUPAL\_\-HASH\_\-LENGTH}}
\index{DRUPAL\_\-HASH\_\-LENGTH@{DRUPAL\_\-HASH\_\-LENGTH}!password.inc@{password.inc}}
\subsubsection[{DRUPAL\_\-HASH\_\-LENGTH}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf DRUPAL\_\-HASH\_\-LENGTH}}}
\label{password_8inc_aeb9d94dcc991ed40a124d8ff153d2782}
The expected (and maximum) number of characters in a hashed password. \hypertarget{password_8inc_aa0eb61e6083023579b85b387475b529f}{
\index{password.inc@{password.inc}!DRUPAL\_\-MAX\_\-HASH\_\-COUNT@{DRUPAL\_\-MAX\_\-HASH\_\-COUNT}}
\index{DRUPAL\_\-MAX\_\-HASH\_\-COUNT@{DRUPAL\_\-MAX\_\-HASH\_\-COUNT}!password.inc@{password.inc}}
\subsubsection[{DRUPAL\_\-MAX\_\-HASH\_\-COUNT}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf DRUPAL\_\-MAX\_\-HASH\_\-COUNT}}}
\label{password_8inc_aa0eb61e6083023579b85b387475b529f}
The maximum allowed log2 number of iterations for password stretching. \hypertarget{password_8inc_ab26271966114a05b9ccb6287c4848309}{
\index{password.inc@{password.inc}!DRUPAL\_\-MIN\_\-HASH\_\-COUNT@{DRUPAL\_\-MIN\_\-HASH\_\-COUNT}}
\index{DRUPAL\_\-MIN\_\-HASH\_\-COUNT@{DRUPAL\_\-MIN\_\-HASH\_\-COUNT}!password.inc@{password.inc}}
\subsubsection[{DRUPAL\_\-MIN\_\-HASH\_\-COUNT}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf DRUPAL\_\-MIN\_\-HASH\_\-COUNT}}}
\label{password_8inc_ab26271966114a05b9ccb6287c4848309}
The minimum allowed log2 number of iterations for password stretching. 

\subsection{Function Documentation}
\hypertarget{password_8inc_ab987820d3546d9284a976236fa42fa59}{
\index{password.inc@{password.inc}!\_\-password\_\-base64\_\-encode@{\_\-password\_\-base64\_\-encode}}
\index{\_\-password\_\-base64\_\-encode@{\_\-password\_\-base64\_\-encode}!password.inc@{password.inc}}
\subsubsection[{\_\-password\_\-base64\_\-encode}]{\setlength{\rightskip}{0pt plus 5cm}\_\-password\_\-base64\_\-encode (\$ {\em input}, \/  \$ {\em count})}}
\label{password_8inc_ab987820d3546d9284a976236fa42fa59}
Encodes bytes into printable base 64 using the $\ast$nix standard from crypt().


\begin{DoxyParams}{Parameters}
\item[{\em \$input}]The string containing bytes to encode. \item[{\em \$count}]The number of characters (bytes) to encode.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Encoded string 
\end{DoxyReturn}
\hypertarget{password_8inc_a857b6008d6928c55df3823524d5c30d2}{
\index{password.inc@{password.inc}!\_\-password\_\-crypt@{\_\-password\_\-crypt}}
\index{\_\-password\_\-crypt@{\_\-password\_\-crypt}!password.inc@{password.inc}}
\subsubsection[{\_\-password\_\-crypt}]{\setlength{\rightskip}{0pt plus 5cm}\_\-password\_\-crypt (\$ {\em algo}, \/  \$ {\em password}, \/  \$ {\em setting})}}
\label{password_8inc_a857b6008d6928c55df3823524d5c30d2}
Hash a password using a secure stretched hash.

By using a salt and repeated hashing the password is \char`\"{}stretched\char`\"{}. Its security is increased because it becomes much more computationally costly for an attacker to try to break the hash by brute-\/force computation of the hashes of a large number of plain-\/text words or strings to find a match.


\begin{DoxyParams}{Parameters}
\item[{\em \$algo}]The string name of a hashing algorithm usable by hash(), like 'sha256'. \item[{\em \$password}]The plain-\/text password to hash. \item[{\em \$setting}]An existing hash or the output of \hyperlink{password_8inc_a0ebe31e5a38758a91dfd23d98f2b719a}{\_\-password\_\-generate\_\-salt()}. Must be at least 12 characters (the settings and salt).\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string containing the hashed password (and salt) or FALSE on failure. The return string will be truncated at DRUPAL\_\-HASH\_\-LENGTH characters max. 
\end{DoxyReturn}
\hypertarget{password_8inc_a65b1a9f521b456c95ec8f8542bd5f59b}{
\index{password.inc@{password.inc}!\_\-password\_\-enforce\_\-log2\_\-boundaries@{\_\-password\_\-enforce\_\-log2\_\-boundaries}}
\index{\_\-password\_\-enforce\_\-log2\_\-boundaries@{\_\-password\_\-enforce\_\-log2\_\-boundaries}!password.inc@{password.inc}}
\subsubsection[{\_\-password\_\-enforce\_\-log2\_\-boundaries}]{\setlength{\rightskip}{0pt plus 5cm}\_\-password\_\-enforce\_\-log2\_\-boundaries (\$ {\em count\_\-log2})}}
\label{password_8inc_a65b1a9f521b456c95ec8f8542bd5f59b}
Ensures that \$count\_\-log2 is within set bounds.


\begin{DoxyParams}{Parameters}
\item[{\em \$count\_\-log2}]Integer that determines the number of iterations used in the hashing process. A larger value is more secure, but takes more time to complete.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Integer within set bounds that is closest to \$count\_\-log2. 
\end{DoxyReturn}
\hypertarget{password_8inc_a0ebe31e5a38758a91dfd23d98f2b719a}{
\index{password.inc@{password.inc}!\_\-password\_\-generate\_\-salt@{\_\-password\_\-generate\_\-salt}}
\index{\_\-password\_\-generate\_\-salt@{\_\-password\_\-generate\_\-salt}!password.inc@{password.inc}}
\subsubsection[{\_\-password\_\-generate\_\-salt}]{\setlength{\rightskip}{0pt plus 5cm}\_\-password\_\-generate\_\-salt (\$ {\em count\_\-log2})}}
\label{password_8inc_a0ebe31e5a38758a91dfd23d98f2b719a}
Generates a random base 64-\/encoded salt prefixed with settings for the hash.

Proper use of salts may defeat a number of attacks, including:
\begin{DoxyItemize}
\item The ability to try candidate passwords against multiple hashes at once.
\item The ability to use pre-\/hashed lists of candidate passwords.
\item The ability to determine whether two users have the same (or different) password without actually having to guess one of the passwords.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
\item[{\em \$count\_\-log2}]Integer that determines the number of iterations used in the hashing process. A larger value is more secure, but takes more time to complete.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A 12 character string containing the iteration count and a random salt. 
\end{DoxyReturn}
\hypertarget{password_8inc_a9af4ef28bcef6a4f53e9eed9735848b5}{
\index{password.inc@{password.inc}!\_\-password\_\-get\_\-count\_\-log2@{\_\-password\_\-get\_\-count\_\-log2}}
\index{\_\-password\_\-get\_\-count\_\-log2@{\_\-password\_\-get\_\-count\_\-log2}!password.inc@{password.inc}}
\subsubsection[{\_\-password\_\-get\_\-count\_\-log2}]{\setlength{\rightskip}{0pt plus 5cm}\_\-password\_\-get\_\-count\_\-log2 (\$ {\em setting})}}
\label{password_8inc_a9af4ef28bcef6a4f53e9eed9735848b5}
Parse the log2 iteration count from a stored hash or setting string. \hypertarget{password_8inc_acfa07cc7bbe581412346fcc7ec03cda3}{
\index{password.inc@{password.inc}!\_\-password\_\-itoa64@{\_\-password\_\-itoa64}}
\index{\_\-password\_\-itoa64@{\_\-password\_\-itoa64}!password.inc@{password.inc}}
\subsubsection[{\_\-password\_\-itoa64}]{\setlength{\rightskip}{0pt plus 5cm}\_\-password\_\-itoa64 ()}}
\label{password_8inc_acfa07cc7bbe581412346fcc7ec03cda3}
Returns a string for mapping an int to the corresponding base 64 character. \hypertarget{password_8inc_a8fca5fd75cd7a3c609e21a48ef087868}{
\index{password.inc@{password.inc}!user\_\-check\_\-password@{user\_\-check\_\-password}}
\index{user\_\-check\_\-password@{user\_\-check\_\-password}!password.inc@{password.inc}}
\subsubsection[{user\_\-check\_\-password}]{\setlength{\rightskip}{0pt plus 5cm}user\_\-check\_\-password (\$ {\em password}, \/  \$ {\em account})}}
\label{password_8inc_a8fca5fd75cd7a3c609e21a48ef087868}
Check whether a plain text password matches a stored hashed password.

Alternative implementations of this function may use other data in the \$account object, for example the uid to look up the hash in a custom table or remote database.


\begin{DoxyParams}{Parameters}
\item[{\em \$password}]A plain-\/text password \item[{\em \$account}]A user object with at least the fields from the \{users\} table.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE or FALSE. 
\end{DoxyReturn}
\hypertarget{password_8inc_a7fa51cbbe5dd15f39953097ea25eb237}{
\index{password.inc@{password.inc}!user\_\-hash\_\-password@{user\_\-hash\_\-password}}
\index{user\_\-hash\_\-password@{user\_\-hash\_\-password}!password.inc@{password.inc}}
\subsubsection[{user\_\-hash\_\-password}]{\setlength{\rightskip}{0pt plus 5cm}user\_\-hash\_\-password (\$ {\em password}, \/  \$ {\em count\_\-log2} = {\ttfamily 0})}}
\label{password_8inc_a7fa51cbbe5dd15f39953097ea25eb237}
Hash a password using a secure hash.


\begin{DoxyParams}{Parameters}
\item[{\em \$password}]A plain-\/text password. \item[{\em \$count\_\-log2}]Optional integer to specify the iteration count. Generally used only during mass operations where a value less than the default is needed for speed.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string containing the hashed password (and a salt), or FALSE on failure. 
\end{DoxyReturn}
\hypertarget{password_8inc_a5c5ff8dd0c7fb7880535bacd445a5574}{
\index{password.inc@{password.inc}!user\_\-needs\_\-new\_\-hash@{user\_\-needs\_\-new\_\-hash}}
\index{user\_\-needs\_\-new\_\-hash@{user\_\-needs\_\-new\_\-hash}!password.inc@{password.inc}}
\subsubsection[{user\_\-needs\_\-new\_\-hash}]{\setlength{\rightskip}{0pt plus 5cm}user\_\-needs\_\-new\_\-hash (\$ {\em account})}}
\label{password_8inc_a5c5ff8dd0c7fb7880535bacd445a5574}
Check whether a user's hashed password needs to be replaced with a new hash.

This is typically called during the login process when the plain text password is available. A new hash is needed when the desired iteration count has changed through a change in the variable password\_\-count\_\-log2 or DRUPAL\_\-HASH\_\-COUNT or if the user's password hash was generated in an update like user\_\-update\_\-7000().

Alternative implementations of this function might use other criteria based on the fields in \$account.


\begin{DoxyParams}{Parameters}
\item[{\em \$account}]A user object with at least the fields from the \{users\} table.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
TRUE or FALSE. 
\end{DoxyReturn}
