\hypertarget{group__database}{
\section{Database abstraction layer}
\label{group__database}\index{Database abstraction layer@{Database abstraction layer}}
}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classDatabaseConnection}{DatabaseConnection}
\item 
class \hyperlink{classDatabase}{Database}
\item 
class \hyperlink{classDatabaseTransactionNoActiveException}{DatabaseTransactionNoActiveException}
\item 
class \hyperlink{classDatabaseTransactionNameNonUniqueException}{DatabaseTransactionNameNonUniqueException}
\item 
class \hyperlink{classDatabaseTransactionCommitFailedException}{DatabaseTransactionCommitFailedException}
\item 
class \hyperlink{classDatabaseTransactionExplicitCommitNotAllowedException}{DatabaseTransactionExplicitCommitNotAllowedException}
\item 
class \hyperlink{classDatabaseTransactionOutOfOrderException}{DatabaseTransactionOutOfOrderException}
\item 
class \hyperlink{classInvalidMergeQueryException}{InvalidMergeQueryException}
\item 
class \hyperlink{classFieldsOverlapException}{FieldsOverlapException}
\item 
class \hyperlink{classNoFieldsException}{NoFieldsException}
\item 
class \hyperlink{classDatabaseConnectionNotDefinedException}{DatabaseConnectionNotDefinedException}
\item 
class \hyperlink{classDatabaseDriverNotSpecifiedException}{DatabaseDriverNotSpecifiedException}
\item 
class \hyperlink{classDatabaseTransaction}{DatabaseTransaction}
\item 
interface \hyperlink{interfaceDatabaseStatementInterface}{DatabaseStatementInterface}
\item 
class \hyperlink{classDatabaseStatementBase}{DatabaseStatementBase}
\item 
class \hyperlink{classDatabaseStatementEmpty}{DatabaseStatementEmpty}
\item 
class \hyperlink{classDatabaseConnection__mysql}{DatabaseConnection\_\-mysql}
\item 
class \hyperlink{classInsertQuery__mysql}{InsertQuery\_\-mysql}
\item 
class \hyperlink{classTruncateQuery__mysql}{TruncateQuery\_\-mysql}
\item 
class \hyperlink{classDatabaseConnection__pgsql}{DatabaseConnection\_\-pgsql}
\item 
class \hyperlink{classSelectQuery__pgsql}{SelectQuery\_\-pgsql}
\item 
class \hyperlink{classDatabaseStatementPrefetch}{DatabaseStatementPrefetch}
\item 
interface \hyperlink{interfaceQueryConditionInterface}{QueryConditionInterface}
\item 
interface \hyperlink{interfaceQueryAlterableInterface}{QueryAlterableInterface}
\item 
interface \hyperlink{interfaceQueryPlaceholderInterface}{QueryPlaceholderInterface}
\item 
class \hyperlink{classQuery}{Query}
\item 
class \hyperlink{classInsertQuery}{InsertQuery}
\item 
class \hyperlink{classDeleteQuery}{DeleteQuery}
\item 
class \hyperlink{classTruncateQuery}{TruncateQuery}
\item 
class \hyperlink{classUpdateQuery}{UpdateQuery}
\item 
class \hyperlink{classMergeQuery}{MergeQuery}
\item 
class \hyperlink{classDatabaseCondition}{DatabaseCondition}
\item 
interface \hyperlink{interfaceQueryExtendableInterface}{QueryExtendableInterface}
\item 
interface \hyperlink{interfaceSelectQueryInterface}{SelectQueryInterface}
\item 
class \hyperlink{classSelectQueryExtender}{SelectQueryExtender}
\item 
class \hyperlink{classSelectQuery}{SelectQuery}
\item 
class \hyperlink{classDatabaseConnection__sqlite}{DatabaseConnection\_\-sqlite}
\item 
class \hyperlink{classDatabaseStatement__sqlite}{DatabaseStatement\_\-sqlite}
\item 
class \hyperlink{classInsertQuery__sqlite}{InsertQuery\_\-sqlite}
\item 
class \hyperlink{classUpdateQuery__sqlite}{UpdateQuery\_\-sqlite}
\item 
class \hyperlink{classDeleteQuery__sqlite}{DeleteQuery\_\-sqlite}
\item 
class \hyperlink{classTruncateQuery__sqlite}{TruncateQuery\_\-sqlite}
\item 
class \hyperlink{classSelectQuery__sqlite}{SelectQuery\_\-sqlite}
\end{DoxyCompactItemize}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{mysql_2query_8inc}{query.inc}
\item 
file \hyperlink{pgsql_2query_8inc}{query.inc}
\item 
file \hyperlink{query_8inc}{query.inc}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group__database_ga9f09406f95a22d365c9faa8721f57126}{POSTGRESQL\_\-NEXTID\_\-LOCK} 
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__database_gafa3b6cb2b2f61479cc63a4150c62da9b}{db\_\-query} (\$query, array \$args=array(), array \$options=array())
\item 
\hyperlink{group__database_gadd8bfb4984a4c69ac741b2bb20d6b9bf}{db\_\-query\_\-range} (\$query, \$from, \$count, array \$args=array(), array \$options=array())
\item 
\hyperlink{group__database_gaac717e09516a8acb0ff82b3a990c13a6}{db\_\-query\_\-temporary} (\$query, array \$args=array(), array \$options=array())
\item 
\hyperlink{group__database_gaadfbffaf30ff5eb14f1bd88619351345}{db\_\-insert} (\$table, array \$options=array())
\item 
\hyperlink{group__database_ga429c73a1bdc6dbb18c4a4a8a2235beaf}{db\_\-merge} (\$table, array \$options=array())
\item 
\hyperlink{group__database_ga40967197ee5d6a23a5c5a77e627067fe}{db\_\-update} (\$table, array \$options=array())
\item 
\hyperlink{group__database_ga72f0ccecc0ba181de16c6e3451150f2c}{db\_\-delete} (\$table, array \$options=array())
\item 
\hyperlink{group__database_gaf6b4b59f572821cfd043317b81eeb71e}{db\_\-truncate} (\$table, array \$options=array())
\item 
\hyperlink{group__database_ga9e030cee657d64e3d8e524c65814cc9f}{db\_\-select} (\$table, \$alias=NULL, array \$options=array())
\item 
\hyperlink{group__database_gabdd0e69f5b2c63f8ad9e76f0fdf552be}{db\_\-transaction} (\$name=NULL, array \$options=array())
\item 
\hyperlink{group__database_ga954d1bbb12742f285927e43f9489fdaf}{db\_\-set\_\-active} (\$key= 'default')
\item 
\hyperlink{group__database_ga3bc27db8c5946da0cab63d9b6314d48d}{db\_\-escape\_\-table} (\$table)
\item 
\hyperlink{group__database_ga7e3c82a45a3e894ce2b4a5a37fa69246}{db\_\-escape\_\-field} (\$field)
\item 
\hyperlink{group__database_ga4e86622a079f0992dbb987e66320be7a}{db\_\-like} (\$string)
\item 
\hyperlink{group__database_gabf958ef859f66154f7fd705eda7a06af}{db\_\-driver} ()
\item 
\hyperlink{group__database_ga3ee89e12a6f70888bfe4ac30f89df442}{db\_\-close} (array \$options=array())
\item 
\hyperlink{group__database_gab0a2cb3e94525a74407740043b821c5b}{db\_\-next\_\-id} (\$existing\_\-id=0)
\item 
\hyperlink{group__database_ga1a7695a360b8c2219fe1998dfc272080}{db\_\-or} ()
\item 
\hyperlink{group__database_ga39ab6e9c3b5316eb4d8fe8f52af91acc}{db\_\-and} ()
\item 
\hyperlink{group__database_ga85bb17ee005f930dd2caa93f0752d0e8}{db\_\-xor} ()
\item 
\hyperlink{group__database_ga7e591c732d1eb7da6813ef79867a9859}{db\_\-condition} (\$conjunction)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Allow the use of different database servers using the same code base.

Drupal provides a database abstraction layer to provide developers with the ability to support multiple database servers easily. The intent of this layer is to preserve the syntax and power of SQL as much as possible, but also allow developers a way to leverage more complex functionality in a unified way. It also provides a structured interface for dynamically constructing queries when appropriate, and enforcing security checks and similar good practices.

The system is built atop PHP's PDO (PHP Data Objects) database API and inherits much of its syntax and semantics.

Most Drupal database SELECT queries are performed by a call to \hyperlink{group__database_gafa3b6cb2b2f61479cc63a4150c62da9b}{db\_\-query()} or \hyperlink{group__database_gadd8bfb4984a4c69ac741b2bb20d6b9bf}{db\_\-query\_\-range()}. Module authors should also consider using the \hyperlink{classPagerDefault}{PagerDefault} Extender for queries that return results that need to be presented on multiple pages, and the Tablesort Extender for generating appropriate queries for sortable tables.

For example, one might wish to return a list of the most recent 10 nodes authored by a given user. Instead of directly issuing the SQL query 
\begin{DoxyCode}
 SELECT n.nid, n.title, n.created FROM node n WHERE n.uid = $uid LIMIT 0, 10;
\end{DoxyCode}
 one would instead call the Drupal functions: 
\begin{DoxyCode}
 $result = db_query_range('SELECT n.nid, n.title, n.created
   FROM {node} n WHERE n.uid = :uid', 0, 10, array(':uid' => $uid));
 foreach ($result as $record) {
   // Perform operations on $record->title, etc. here.
 }
\end{DoxyCode}
 Curly braces are used around \char`\"{}node\char`\"{} to provide table prefixing via \hyperlink{classDatabaseConnection_a10dfbe0177bc8c79a8589cc84afe24dd}{DatabaseConnection::prefixTables()}. The explicit use of a user ID is pulled out into an argument passed to \hyperlink{group__database_gafa3b6cb2b2f61479cc63a4150c62da9b}{db\_\-query()} so that SQL injection attacks from user input can be caught and nullified. The LIMIT syntax varies between database servers, so that is abstracted into \hyperlink{group__database_gadd8bfb4984a4c69ac741b2bb20d6b9bf}{db\_\-query\_\-range()} arguments. Finally, note the PDO-\/based ability to iterate over the result set using foreach ().

All queries are passed as a prepared statement string. A prepared statement is a \char`\"{}template\char`\"{} of a query that omits literal or variable values in favor of placeholders. The values to place into those placeholders are passed separately, and the database driver handles inserting the values into the query in a secure fashion. That means you should never quote or string-\/escape a value to be inserted into the query.

There are two formats for placeholders: named and unnamed. Named placeholders are strongly preferred in all cases as they are more flexible and self-\/documenting. Named placeholders should start with a colon \char`\"{}:\char`\"{} and can be followed by one or more letters, numbers or underscores.

Named placeholders begin with a colon followed by a unique string. Example: 
\begin{DoxyCode}
 SELECT nid, title FROM {node} WHERE uid=:uid;
\end{DoxyCode}


\char`\"{}:uid\char`\"{} is a placeholder that will be replaced with a literal value when the query is executed. A given placeholder label cannot be repeated in a given query, even if the value should be the same. When using named placeholders, the array of arguments to the query must be an associative array where keys are a placeholder label (e.g., :uid) and the value is the corresponding value to use. The array may be in any order.

Unnamed placeholders are simply a question mark. Example: 
\begin{DoxyCode}
 SELECT nid, title FROM {node} WHERE uid=?;
\end{DoxyCode}


In this case, the array of arguments must be an indexed array of values to use in the exact same order as the placeholders in the query.

Note that placeholders should be a \char`\"{}complete\char`\"{} value. For example, when running a LIKE query the SQL wildcard character, \%, should be part of the value, not the query itself. Thus, the following is incorrect: 
\begin{DoxyCode}
 SELECT nid, title FROM {node} WHERE title LIKE :title%;
\end{DoxyCode}
 It should instead read: 
\begin{DoxyCode}
 SELECT nid, title FROM {node} WHERE title LIKE :title;
\end{DoxyCode}
 and the value for :title should include a \% as appropriate. Again, note the lack of quotation marks around :title. Because the value is not inserted into the query as one big string but as an explicitly separate value, the database server knows where the query ends and a value begins. That is considerably more secure against SQL injection than trying to remember which values need quotation marks and string escaping and which don't.

INSERT, UPDATE, and DELETE queries need special care in order to behave consistently across all different databases. Therefore, they use a special object-\/oriented API for defining a query structurally. For example, rather than: 
\begin{DoxyCode}
 INSERT INTO node (nid, title, body) VALUES (1, 'my title', 'my body');
\end{DoxyCode}
 one would instead write: 
\begin{DoxyCode}
 $fields = array('nid' => 1, 'title' => 'my title', 'body' => 'my body');
 db_insert('node')->fields($fields)->execute();
\end{DoxyCode}
 This method allows databases that need special data type handling to do so, while also allowing optimizations such as multi-\/insert queries. UPDATE and DELETE queries have a similar pattern.

Drupal also supports transactions, including a transparent fallback for databases that do not support transactions. To start a new transaction, simply call \$txn = \hyperlink{group__database_gabdd0e69f5b2c63f8ad9e76f0fdf552be}{db\_\-transaction()}; in your own code. The transaction will remain open for as long as the variable \$txn remains in scope. When \$txn is destroyed, the transaction will be committed. If your transaction is nested inside of another then Drupal will track each transaction and only commit the outer-\/most transaction when the last transaction object goes out out of scope, that is, all relevant queries completed successfully.

Example: 
\begin{DoxyCode}
 function my_transaction_function() {
   // The transaction opens here.
   $txn = db_transaction();

   try {
     $id = db_insert('example')
       ->fields(array(
         'field1' => 'mystring',
         'field2' => 5,
       ))
       ->execute();

     my_other_function($id);

     return $id;
   }
   catch (Exception $e) {
     // Something went wrong somewhere, so roll back now.
     $txn->rollback();
     // Log the exception to watchdog.
     watchdog_exception('type', $e);
   }

   // $txn goes out of scope here.  Unless the transaction was rolled back, it
   // gets automatically committed here.
 }

 function my_other_function($id) {
   // The transaction is still open here.

   if ($id % 2 == 0) {
     db_update('example')
       ->condition('id', $id)
       ->fields(array('field2' => 10))
       ->execute();
   }
 }
\end{DoxyCode}


\begin{DoxySeeAlso}{See also}
\href{http://drupal.org/developing/api/database}{\tt http://drupal.org/developing/api/database} 
\end{DoxySeeAlso}


\subsection{Enumeration Type Documentation}
\hypertarget{group__database_ga9f09406f95a22d365c9faa8721f57126}{
\index{database@{database}!POSTGRESQL\_\-NEXTID\_\-LOCK@{POSTGRESQL\_\-NEXTID\_\-LOCK}}
\index{POSTGRESQL\_\-NEXTID\_\-LOCK@{POSTGRESQL\_\-NEXTID\_\-LOCK}!database@{database}}
\subsubsection[{POSTGRESQL\_\-NEXTID\_\-LOCK}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf POSTGRESQL\_\-NEXTID\_\-LOCK}}}
\label{group__database_ga9f09406f95a22d365c9faa8721f57126}
The name by which to obtain a lock for retrive the next insert id. 

\subsection{Function Documentation}
\hypertarget{group__database_ga39ab6e9c3b5316eb4d8fe8f52af91acc}{
\index{database@{database}!db\_\-and@{db\_\-and}}
\index{db\_\-and@{db\_\-and}!database@{database}}
\subsubsection[{db\_\-and}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-and ()}}
\label{group__database_ga39ab6e9c3b5316eb4d8fe8f52af91acc}
Returns a new \hyperlink{classDatabaseCondition}{DatabaseCondition}, set to \char`\"{}AND\char`\"{} all conditions together.

\begin{DoxyReturn}{Returns}
\hyperlink{classDatabaseCondition}{DatabaseCondition} 
\end{DoxyReturn}
\hypertarget{group__database_ga3ee89e12a6f70888bfe4ac30f89df442}{
\index{database@{database}!db\_\-close@{db\_\-close}}
\index{db\_\-close@{db\_\-close}!database@{database}}
\subsubsection[{db\_\-close}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-close (array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_ga3ee89e12a6f70888bfe4ac30f89df442}
Closes the active database connection.


\begin{DoxyParams}{Parameters}
\item[{\em \$options}]An array of options to control which connection is closed. Only the target key has any meaning in this case. \end{DoxyParams}
\hypertarget{group__database_ga7e591c732d1eb7da6813ef79867a9859}{
\index{database@{database}!db\_\-condition@{db\_\-condition}}
\index{db\_\-condition@{db\_\-condition}!database@{database}}
\subsubsection[{db\_\-condition}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-condition (\$ {\em conjunction})}}
\label{group__database_ga7e591c732d1eb7da6813ef79867a9859}
Returns a new \hyperlink{classDatabaseCondition}{DatabaseCondition}, set to the specified conjunction.

Internal API function call. The \hyperlink{group__database_ga39ab6e9c3b5316eb4d8fe8f52af91acc}{db\_\-and()}, \hyperlink{group__database_ga1a7695a360b8c2219fe1998dfc272080}{db\_\-or()}, and \hyperlink{group__database_ga85bb17ee005f930dd2caa93f0752d0e8}{db\_\-xor()} functions are preferred.


\begin{DoxyParams}{Parameters}
\item[{\em \$conjunction}]The conjunction to use for query conditions (AND, OR or XOR). \end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classDatabaseCondition}{DatabaseCondition} 
\end{DoxyReturn}
\hypertarget{group__database_ga72f0ccecc0ba181de16c6e3451150f2c}{
\index{database@{database}!db\_\-delete@{db\_\-delete}}
\index{db\_\-delete@{db\_\-delete}!database@{database}}
\subsubsection[{db\_\-delete}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-delete (\$ {\em table}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_ga72f0ccecc0ba181de16c6e3451150f2c}
Returns a new \hyperlink{classDeleteQuery}{DeleteQuery} object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The table from which to delete. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classDeleteQuery}{DeleteQuery} A new \hyperlink{classDeleteQuery}{DeleteQuery} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_gabf958ef859f66154f7fd705eda7a06af}{
\index{database@{database}!db\_\-driver@{db\_\-driver}}
\index{db\_\-driver@{db\_\-driver}!database@{database}}
\subsubsection[{db\_\-driver}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-driver ()}}
\label{group__database_gabf958ef859f66154f7fd705eda7a06af}
Retrieves the name of the currently active database driver.

\begin{DoxyReturn}{Returns}
The name of the currently active database driver. 
\end{DoxyReturn}
\hypertarget{group__database_ga7e3c82a45a3e894ce2b4a5a37fa69246}{
\index{database@{database}!db\_\-escape\_\-field@{db\_\-escape\_\-field}}
\index{db\_\-escape\_\-field@{db\_\-escape\_\-field}!database@{database}}
\subsubsection[{db\_\-escape\_\-field}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-escape\_\-field (\$ {\em field})}}
\label{group__database_ga7e3c82a45a3e894ce2b4a5a37fa69246}
Restricts a dynamic column or constraint name to safe characters.

Only keeps alphanumeric and underscores.


\begin{DoxyParams}{Parameters}
\item[{\em \$field}]The field name to escape.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The escaped field name as a string. 
\end{DoxyReturn}
\hypertarget{group__database_ga3bc27db8c5946da0cab63d9b6314d48d}{
\index{database@{database}!db\_\-escape\_\-table@{db\_\-escape\_\-table}}
\index{db\_\-escape\_\-table@{db\_\-escape\_\-table}!database@{database}}
\subsubsection[{db\_\-escape\_\-table}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-escape\_\-table (\$ {\em table})}}
\label{group__database_ga3bc27db8c5946da0cab63d9b6314d48d}
Restricts a dynamic table name to safe characters.

Only keeps alphanumeric and underscores.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The table name to escape.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The escaped table name as a string. 
\end{DoxyReturn}
\hypertarget{group__database_gaadfbffaf30ff5eb14f1bd88619351345}{
\index{database@{database}!db\_\-insert@{db\_\-insert}}
\index{db\_\-insert@{db\_\-insert}!database@{database}}
\subsubsection[{db\_\-insert}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-insert (\$ {\em table}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_gaadfbffaf30ff5eb14f1bd88619351345}
Returns a new \hyperlink{classInsertQuery}{InsertQuery} object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The table into which to insert. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classInsertQuery}{InsertQuery} A new \hyperlink{classInsertQuery}{InsertQuery} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_ga4e86622a079f0992dbb987e66320be7a}{
\index{database@{database}!db\_\-like@{db\_\-like}}
\index{db\_\-like@{db\_\-like}!database@{database}}
\subsubsection[{db\_\-like}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-like (\$ {\em string})}}
\label{group__database_ga4e86622a079f0992dbb987e66320be7a}
Escapes characters that work as wildcard characters in a LIKE pattern.

The wildcard characters \char`\"{}\%\char`\"{} and \char`\"{}\_\-\char`\"{} as well as backslash are prefixed with a backslash. Use this to do a search for a verbatim string without any wildcard behavior.

For example, the following does a case-\/insensitive query for all rows whose name starts with \$prefix: 
\begin{DoxyCode}
 $result = db_query(
   'SELECT * FROM person WHERE name LIKE :pattern',
   array(':pattern' => db_like($prefix) . '%')
 );
\end{DoxyCode}


Backslash is defined as escape character for LIKE patterns in \hyperlink{classDatabaseCondition_afb4e820b6d1719bf940526beef27dc7a}{DatabaseCondition::mapConditionOperator()}.


\begin{DoxyParams}{Parameters}
\item[{\em \$string}]The string to escape.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The escaped string. 
\end{DoxyReturn}
\hypertarget{group__database_ga429c73a1bdc6dbb18c4a4a8a2235beaf}{
\index{database@{database}!db\_\-merge@{db\_\-merge}}
\index{db\_\-merge@{db\_\-merge}!database@{database}}
\subsubsection[{db\_\-merge}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-merge (\$ {\em table}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_ga429c73a1bdc6dbb18c4a4a8a2235beaf}
Returns a new \hyperlink{classMergeQuery}{MergeQuery} object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The table into which to merge. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classMergeQuery}{MergeQuery} A new \hyperlink{classMergeQuery}{MergeQuery} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_gab0a2cb3e94525a74407740043b821c5b}{
\index{database@{database}!db\_\-next\_\-id@{db\_\-next\_\-id}}
\index{db\_\-next\_\-id@{db\_\-next\_\-id}!database@{database}}
\subsubsection[{db\_\-next\_\-id}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-next\_\-id (\$ {\em existing\_\-id} = {\ttfamily 0})}}
\label{group__database_gab0a2cb3e94525a74407740043b821c5b}
Retrieves a unique id.

Use this function if for some reason you can't use a serial field. Using a serial field is preferred, and \hyperlink{classInsertQuery_a9bcd2f989e2ae0173bd6f58b6ede12fc}{InsertQuery::execute()} returns the value of the last ID inserted.


\begin{DoxyParams}{Parameters}
\item[{\em \$existing\_\-id}]After a database import, it might be that the sequences table is behind, so by passing in a minimum ID, it can be assured that we never issue the same ID.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An integer number larger than any number returned before for this sequence. 
\end{DoxyReturn}
\hypertarget{group__database_ga1a7695a360b8c2219fe1998dfc272080}{
\index{database@{database}!db\_\-or@{db\_\-or}}
\index{db\_\-or@{db\_\-or}!database@{database}}
\subsubsection[{db\_\-or}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-or ()}}
\label{group__database_ga1a7695a360b8c2219fe1998dfc272080}
Returns a new \hyperlink{classDatabaseCondition}{DatabaseCondition}, set to \char`\"{}OR\char`\"{} all conditions together.

\begin{DoxyReturn}{Returns}
\hyperlink{classDatabaseCondition}{DatabaseCondition} 
\end{DoxyReturn}
\hypertarget{group__database_gafa3b6cb2b2f61479cc63a4150c62da9b}{
\index{database@{database}!db\_\-query@{db\_\-query}}
\index{db\_\-query@{db\_\-query}!database@{database}}
\subsubsection[{db\_\-query}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-query (\$ {\em query}, \/  array \$ {\em args} = {\ttfamily array()}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_gafa3b6cb2b2f61479cc63a4150c62da9b}
The following utility functions are simply convenience wrappers.

They should never, ever have any database-\/specific code in them. Executes an arbitrary query string against the active database.

Use this function for SELECT queries if it is just a simple query string. If the caller or other modules need to change the query, use \hyperlink{group__database_ga9e030cee657d64e3d8e524c65814cc9f}{db\_\-select()} instead.

Do not use this function for INSERT, UPDATE, or DELETE queries. Those should be handled via \hyperlink{group__database_gaadfbffaf30ff5eb14f1bd88619351345}{db\_\-insert()}, \hyperlink{group__database_ga40967197ee5d6a23a5c5a77e627067fe}{db\_\-update()} and \hyperlink{group__database_ga72f0ccecc0ba181de16c6e3451150f2c}{db\_\-delete()} respectively.


\begin{DoxyParams}{Parameters}
\item[{\em \$query}]The prepared statement query to run. Although it will accept both named and unnamed placeholders, named placeholders are strongly preferred as they are more self-\/documenting. \item[{\em \$args}]An array of values to substitute into the query. If the query uses named placeholders, this is an associative array in any order. If the query uses unnamed placeholders (?), this is an indexed array and the order must match the order of placeholders in the query string. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{interfaceDatabaseStatementInterface}{DatabaseStatementInterface} A prepared statement object, already executed.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{classDatabaseConnection_a190539d6c494ef2d7ac90d21226de5a5}{DatabaseConnection::defaultOptions()} 
\end{DoxySeeAlso}
\hypertarget{group__database_gadd8bfb4984a4c69ac741b2bb20d6b9bf}{
\index{database@{database}!db\_\-query\_\-range@{db\_\-query\_\-range}}
\index{db\_\-query\_\-range@{db\_\-query\_\-range}!database@{database}}
\subsubsection[{db\_\-query\_\-range}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-query\_\-range (\$ {\em query}, \/  \$ {\em from}, \/  \$ {\em count}, \/  array \$ {\em args} = {\ttfamily array()}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_gadd8bfb4984a4c69ac741b2bb20d6b9bf}
Executes a query against the active database, restricted to a range.


\begin{DoxyParams}{Parameters}
\item[{\em \$query}]The prepared statement query to run. Although it will accept both named and unnamed placeholders, named placeholders are strongly preferred as they are more self-\/documenting. \item[{\em \$from}]The first record from the result set to return. \item[{\em \$count}]The number of records to return from the result set. \item[{\em \$args}]An array of values to substitute into the query. If the query uses named placeholders, this is an associative array in any order. If the query uses unnamed placeholders (?), this is an indexed array and the order must match the order of placeholders in the query string. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{interfaceDatabaseStatementInterface}{DatabaseStatementInterface} A prepared statement object, already executed.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{classDatabaseConnection_a190539d6c494ef2d7ac90d21226de5a5}{DatabaseConnection::defaultOptions()} 
\end{DoxySeeAlso}
\hypertarget{group__database_gaac717e09516a8acb0ff82b3a990c13a6}{
\index{database@{database}!db\_\-query\_\-temporary@{db\_\-query\_\-temporary}}
\index{db\_\-query\_\-temporary@{db\_\-query\_\-temporary}!database@{database}}
\subsubsection[{db\_\-query\_\-temporary}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-query\_\-temporary (\$ {\em query}, \/  array \$ {\em args} = {\ttfamily array()}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_gaac717e09516a8acb0ff82b3a990c13a6}
Executes a query string and saves the result set to a temporary table.

The execution of the query string happens against the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$query}]The prepared statement query to run. Although it will accept both named and unnamed placeholders, named placeholders are strongly preferred as they are more self-\/documenting. \item[{\em \$args}]An array of values to substitute into the query. If the query uses named placeholders, this is an associative array in any order. If the query uses unnamed placeholders (?), this is an indexed array and the order must match the order of placeholders in the query string. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The name of the temporary table.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{classDatabaseConnection_a190539d6c494ef2d7ac90d21226de5a5}{DatabaseConnection::defaultOptions()} 
\end{DoxySeeAlso}
\hypertarget{group__database_ga9e030cee657d64e3d8e524c65814cc9f}{
\index{database@{database}!db\_\-select@{db\_\-select}}
\index{db\_\-select@{db\_\-select}!database@{database}}
\subsubsection[{db\_\-select}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-select (\$ {\em table}, \/  \$ {\em alias} = {\ttfamily NULL}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_ga9e030cee657d64e3d8e524c65814cc9f}
Returns a new \hyperlink{classSelectQuery}{SelectQuery} object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The base table for this query. May be a string or another \hyperlink{classSelectQuery}{SelectQuery} object. If a query object is passed, it will be used as a subselect. \item[{\em \$alias}]The alias for the base table of this query. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classSelectQuery}{SelectQuery} A new \hyperlink{classSelectQuery}{SelectQuery} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_ga954d1bbb12742f285927e43f9489fdaf}{
\index{database@{database}!db\_\-set\_\-active@{db\_\-set\_\-active}}
\index{db\_\-set\_\-active@{db\_\-set\_\-active}!database@{database}}
\subsubsection[{db\_\-set\_\-active}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-set\_\-active (\$ {\em key} = {\ttfamily 'default'})}}
\label{group__database_ga954d1bbb12742f285927e43f9489fdaf}
Sets a new active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$key}]The key in the \$databases array to set as the default database.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The key of the formerly active database. 
\end{DoxyReturn}
\hypertarget{group__database_gabdd0e69f5b2c63f8ad9e76f0fdf552be}{
\index{database@{database}!db\_\-transaction@{db\_\-transaction}}
\index{db\_\-transaction@{db\_\-transaction}!database@{database}}
\subsubsection[{db\_\-transaction}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-transaction (\$ {\em name} = {\ttfamily NULL}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_gabdd0e69f5b2c63f8ad9e76f0fdf552be}
Returns a new transaction object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em string}]\$name Optional name of the transaction. \item[{\em array}]\$options An array of options to control how the transaction operates:
\begin{DoxyItemize}
\item target: The database target name.
\end{DoxyItemize}\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classDatabaseTransaction}{DatabaseTransaction} A new \hyperlink{classDatabaseTransaction}{DatabaseTransaction} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_gaf6b4b59f572821cfd043317b81eeb71e}{
\index{database@{database}!db\_\-truncate@{db\_\-truncate}}
\index{db\_\-truncate@{db\_\-truncate}!database@{database}}
\subsubsection[{db\_\-truncate}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-truncate (\$ {\em table}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_gaf6b4b59f572821cfd043317b81eeb71e}
Returns a new \hyperlink{classTruncateQuery}{TruncateQuery} object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The table from which to delete. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classTruncateQuery}{TruncateQuery} A new \hyperlink{classTruncateQuery}{TruncateQuery} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_ga40967197ee5d6a23a5c5a77e627067fe}{
\index{database@{database}!db\_\-update@{db\_\-update}}
\index{db\_\-update@{db\_\-update}!database@{database}}
\subsubsection[{db\_\-update}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-update (\$ {\em table}, \/  array \$ {\em options} = {\ttfamily array()})}}
\label{group__database_ga40967197ee5d6a23a5c5a77e627067fe}
Returns a new \hyperlink{classUpdateQuery}{UpdateQuery} object for the active database.


\begin{DoxyParams}{Parameters}
\item[{\em \$table}]The table to update. \item[{\em \$options}]An array of options to control how the query operates.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{classUpdateQuery}{UpdateQuery} A new \hyperlink{classUpdateQuery}{UpdateQuery} object for this connection. 
\end{DoxyReturn}
\hypertarget{group__database_ga85bb17ee005f930dd2caa93f0752d0e8}{
\index{database@{database}!db\_\-xor@{db\_\-xor}}
\index{db\_\-xor@{db\_\-xor}!database@{database}}
\subsubsection[{db\_\-xor}]{\setlength{\rightskip}{0pt plus 5cm}db\_\-xor ()}}
\label{group__database_ga85bb17ee005f930dd2caa93f0752d0e8}
Returns a new \hyperlink{classDatabaseCondition}{DatabaseCondition}, set to \char`\"{}XOR\char`\"{} all conditions together.

\begin{DoxyReturn}{Returns}
\hyperlink{classDatabaseCondition}{DatabaseCondition} 
\end{DoxyReturn}
