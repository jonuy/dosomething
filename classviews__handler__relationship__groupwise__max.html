<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DoSomething.org: views_handler_relationship_groupwise_max Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>views_handler_relationship_groupwise_max Class Reference<br/>
<small>
[<a class="el" href="group__views__relationship__handlers.html">Views relationship handlers</a>]</small>
</h1><!-- doxytag: class="views_handler_relationship_groupwise_max" --><!-- doxytag: inherits="views_handler_relationship" --><div class="dynheader">
Inheritance diagram for views_handler_relationship_groupwise_max:</div>
<div class="dynsection">
 <div class="center">
  <img src="classviews__handler__relationship__groupwise__max.gif" usemap="#views_handler_relationship_groupwise_max_map" alt=""/>
  <map id="views_handler_relationship_groupwise_max_map" name="views_handler_relationship_groupwise_max_map">
<area href="classviews__handler__relationship.html" alt="views_handler_relationship" shape="rect" coords="0,56,260,80"/>
<area href="classviews__handler.html" alt="views_handler" shape="rect" coords="0,0,260,24"/>
</map>
 </div>
</div>

<p><a href="classviews__handler__relationship__groupwise__max-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#a915d653a4dd09cc8968c616427a87f92">option_definition</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#a9cac8b627e41265e500d1a36f4d8f621">options_form</a> (&amp;$form, &amp;$form_state)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#a2af65fae1b0d97331ccf817be451399c">get_temporary_view</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#a33dd614a3c4506afe9a3746712713724">options_form_submit</a> (&amp;$form, &amp;$form_state)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#af16a972d2e2cccfc5d56495c9e15f42f">left_query</a> ($options)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#a70411d08b3516619b376be6b3411d70c">alter_subquery_condition</a> (QueryAlterableInterface $query, &amp;$conditions)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#af6f3f64602d39ea3f4620f06534c5779">condition_namespace</a> ($string)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classviews__handler__relationship__groupwise__max.html#a26fd71d0c45deea3dcd04e40fe58df7c">query</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Relationship handler that allows a groupwise maximum of the linked in table. For a definition, see: <a href="http://dev.mysql.com/doc/refman/5.0/en/example-maximum-column-group-row.html">http://dev.mysql.com/doc/refman/5.0/en/example-maximum-column-group-row.html</a> In lay terms, instead of joining to get all matching records in the linked table, we get only one record, a 'representative record' picked according to a given criteria.</p>
<p>Example: Suppose we have a term <a class="el" href="classview.html">view</a> that gives us the terms: Horse, Cat, Aardvark. We wish to show for each term the most recent node of that term. What we want is some kind of relationship from term to node. But a regular relationship will give us all the nodes for each term, giving the <a class="el" href="classview.html">view</a> multiple rows per term. What we want is just one representative node per term, the node that is the 'best' in some way: eg, the most recent, the most commented on, the first in alphabetical order.</p>
<p>This handler gives us that kind of relationship from term to node. The method of choosing the 'best' implemented with a sort that the user selects in the relationship settings.</p>
<p>So if we want our term <a class="el" href="classview.html">view</a> to show the most commented node for each term, add the relationship and in its options, pick the 'Comment count' sort.</p>
<p>Relationship definition</p>
<ul>
<li>'outer field': The outer field to substitute into the correlated subquery. This must be the full field name, not the alias. Eg: 'term_data.tid'.</li>
<li>'argument table', 'argument field': These options define a views argument that the subquery must add to itself to filter by the main <a class="el" href="classview.html">view</a>. Example: the main <a class="el" href="classview.html">view</a> shows terms, this handler is being used to get to the nodes base table. Your argument must be 'term_node', 'tid', as this is the argument that should be added to a node <a class="el" href="classview.html">view</a> to filter on terms.</li>
</ul>
<p>A note on performance: This relationship uses a correlated subquery, which is expensive. Subsequent versions of this handler could also implement the alternative way of doing this, with a join -- though this looks like it could be pretty messy to implement. This is also an expensive method, so providing both methods and allowing the user to choose which one works fastest for their data might be the best way. If your use of this relationship handler is likely to result in large data sets, you might want to consider storing statistics in a separate table, in the same way as node_comment_statistics. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a70411d08b3516619b376be6b3411d70c"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::alter_subquery_condition" ref="a70411d08b3516619b376be6b3411d70c" args="(QueryAlterableInterface $query, &amp;$conditions)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::alter_subquery_condition </td>
          <td>(</td>
          <td class="paramtype">QueryAlterableInterface $&nbsp;</td>
          <td class="paramname"> <em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>conditions</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Recursive helper to add a namespace to conditions.</p>
<p>Similar to <a class="el" href="views_8module.html#a51cb108c148c7478b50e6262e216a17d">_views_query_tag_alter_condition()</a>.</p>
<p>(Though why is the condition we get in a simple query 3 levels deep???) </p>

</div>
</div>
<a class="anchor" id="af6f3f64602d39ea3f4620f06534c5779"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::condition_namespace" ref="af6f3f64602d39ea3f4620f06534c5779" args="($string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::condition_namespace </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>string</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Helper function to namespace query pieces.</p>
<p>Turns 'foo.bar' into 'foo_NAMESPACE.bar'. </p>

</div>
</div>
<a class="anchor" id="a2af65fae1b0d97331ccf817be451399c"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::get_temporary_view" ref="a2af65fae1b0d97331ccf817be451399c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::get_temporary_view </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Helper function to create a pseudo <a class="el" href="classview.html">view</a>.</p>
<p>We use this to obtain our subquery SQL. </p>

</div>
</div>
<a class="anchor" id="af16a972d2e2cccfc5d56495c9e15f42f"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::left_query" ref="af16a972d2e2cccfc5d56495c9e15f42f" args="($options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::left_query </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>options</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generate a subquery given the user options, as set in the options. These are passed in rather than picked up from the object because we generate the subquery when the options are saved, rather than when the <a class="el" href="classview.html">view</a> is run. This saves considerable time.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$options</em>&nbsp;</td><td>An array of options:</p>
<ul>
<li>subquery_sort: the id of a views sort.</li>
<li>subquery_order: either ASC or DESC. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The subquery SQL string, ready for use in the main query. </dd></dl>

</div>
</div>
<a class="anchor" id="a915d653a4dd09cc8968c616427a87f92"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::option_definition" ref="a915d653a4dd09cc8968c616427a87f92" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::option_definition </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Defines default values for options. </p>

<p>Reimplemented from <a class="el" href="classviews__handler__relationship.html">views_handler_relationship</a>.</p>

</div>
</div>
<a class="anchor" id="a9cac8b627e41265e500d1a36f4d8f621"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::options_form" ref="a9cac8b627e41265e500d1a36f4d8f621" args="(&amp;$form, &amp;$form_state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::options_form </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>form</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>form_state</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extends the relationship's basic options, allowing the user to pick a sort and an order for it. </p>

<p>Reimplemented from <a class="el" href="classviews__handler__relationship.html#a08cc3f5947964d936b5e88d198f82c30">views_handler_relationship</a>.</p>

</div>
</div>
<a class="anchor" id="a33dd614a3c4506afe9a3746712713724"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::options_form_submit" ref="a33dd614a3c4506afe9a3746712713724" args="(&amp;$form, &amp;$form_state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::options_form_submit </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>form</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>form_state</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>When the form is submitted, take sure to clear the subquery string cache. </p>

</div>
</div>
<a class="anchor" id="a26fd71d0c45deea3dcd04e40fe58df7c"></a><!-- doxytag: member="views_handler_relationship_groupwise_max::query" ref="a26fd71d0c45deea3dcd04e40fe58df7c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">views_handler_relationship_groupwise_max::query </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called to implement a relationship in a query. This is mostly a copy of our parent's <a class="el" href="classviews__handler__relationship__groupwise__max.html#a26fd71d0c45deea3dcd04e40fe58df7c">query()</a> except for this bit with the join class. </p>

<p>Reimplemented from <a class="el" href="classviews__handler__relationship.html#a7dc0b6371807dbf06efa594cb52b3348">views_handler_relationship</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>html/profiles/dosomething/modules/contrib/views/handlers/<a class="el" href="views__handler__relationship__groupwise__max_8inc.html">views_handler_relationship_groupwise_max.inc</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 8 Nov 2013 for DoSomething.org by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
