<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DoSomething.org: html/modules/update/update.fetch.inc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>html/modules/update/update.fetch.inc File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#acb92114e3c9f719e50f66ac62ff78e01">update_manual_status</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a7975896014a8fc9b4e14306a875b97f2">update_fetch_data_batch</a> (&amp;$context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#ac901625f220862b797fb5c5cc4dcb654">update_fetch_data_finished</a> ($success, $results)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a3a3122bc6fdfe23091d8db56e4430aeb">_update_fetch_data</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task</a> ($project)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#aa9814236d331f2e6822435215e9acd8e">_update_refresh</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a8b22762aaa27e7a0927f4f3ad09ad5e1">_update_create_fetch_task</a> ($project)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a6d937d41a6ccf645109deefae0f6e5d3">_update_build_fetch_url</a> ($project, $site_key= '')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a53552af8849428ac6faba273936eb00a">_update_get_fetch_url_base</a> ($project)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a55d78e25faf69f49cfc88f2642c06f4e">_update_cron_notify</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="update_8fetch_8inc.html#a3d8f5a924c1de0728c829d3c92d60d19">update_parse_xml</a> ($raw_xml)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Code required only when fetching information about available updates. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6d937d41a6ccf645109deefae0f6e5d3"></a><!-- doxytag: member="update.fetch.inc::_update_build_fetch_url" ref="a6d937d41a6ccf645109deefae0f6e5d3" args="($project, $site_key= '')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_build_fetch_url </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>site_key</em> = <code>''</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generates the URL to fetch information about project updates.</p>
<p>This figures out the right URL to use, based on the project's .info file and the global defaults. Appends optional query arguments when the site is configured to report usage stats.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$project</em>&nbsp;</td><td>The array of project information from <a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$site_key</em>&nbsp;</td><td>(optional) The anonymous site key hash. Defaults to an empty string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The URL for fetching information about updates to the specified project.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="update_8module.html#a88528fa85108af5a0b26ab5b1d6fa8c2">update_fetch_data()</a> </dd>
<dd>
<a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task()</a> </dd>
<dd>
<a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a8b22762aaa27e7a0927f4f3ad09ad5e1"></a><!-- doxytag: member="update.fetch.inc::_update_create_fetch_task" ref="a8b22762aaa27e7a0927f4f3ad09ad5e1" args="($project)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_create_fetch_task </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>project</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds a task to the queue for fetching release history data for a project.</p>
<p>We only create a new fetch task if there's no task already in the queue for this particular project (based on 'fetch_task::' entries in the {cache_update} table).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$project</em>&nbsp;</td><td>Associative array of information about a project as created by <a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a>, including keys such as 'name' (short name), and the 'info' array with data from a .info file for the project.</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a> </dd>
<dd>
<a class="el" href="update_8module.html#a683663ab0739a0d67fe3eb98f532c11c">update_get_available()</a> </dd>
<dd>
<a class="el" href="update_8module.html#a601f9ec9c404ec41711b00884e7d0573">update_refresh()</a> </dd>
<dd>
<a class="el" href="update_8module.html#a88528fa85108af5a0b26ab5b1d6fa8c2">update_fetch_data()</a> </dd>
<dd>
<a class="el" href="update_8fetch_8inc.html#a49b627a7dcb3c714f088bc0e7ef40e85">_update_process_fetch_task()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a55d78e25faf69f49cfc88f2642c06f4e"></a><!-- doxytag: member="update.fetch.inc::_update_cron_notify" ref="a55d78e25faf69f49cfc88f2642c06f4e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_cron_notify </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs any notifications that should be done once cron fetches new data.</p>
<p>This method checks the status of the site using the new data and, depending on the configuration of the site, notifies administrators via e-mail if there are new releases or missing security updates.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>update_requirements() </dd></dl>

</div>
</div>
<a class="anchor" id="a3a3122bc6fdfe23091d8db56e4430aeb"></a><!-- doxytag: member="update.fetch.inc::_update_fetch_data" ref="a3a3122bc6fdfe23091d8db56e4430aeb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_fetch_data </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Attempts to drain the queue of tasks for release history data to fetch. </p>

</div>
</div>
<a class="anchor" id="a53552af8849428ac6faba273936eb00a"></a><!-- doxytag: member="update.fetch.inc::_update_get_fetch_url_base" ref="a53552af8849428ac6faba273936eb00a" args="($project)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_get_fetch_url_base </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>project</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the base of the URL to fetch available update data for a project.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$project</em>&nbsp;</td><td>The array of project information from <a class="el" href="update_8compare_8inc.html#a7e1ea49d91f2d2b81b8101d481d10300">update_get_projects()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The base of the URL used for fetching available update data. This does not include the path elements to specify a particular project, version, site_key, etc.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="update_8fetch_8inc.html#a6d937d41a6ccf645109deefae0f6e5d3">_update_build_fetch_url()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a49b627a7dcb3c714f088bc0e7ef40e85"></a><!-- doxytag: member="update.fetch.inc::_update_process_fetch_task" ref="a49b627a7dcb3c714f088bc0e7ef40e85" args="($project)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_process_fetch_task </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>project</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes a task to fetch available update data for a single project.</p>
<p>Once the release history XML data is downloaded, it is parsed and saved into the {cache_update} table in an entry just for that project.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$project</em>&nbsp;</td><td>Associative array of information about the project to fetch data for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if we fetched parsable XML, otherwise FALSE. </dd></dl>

</div>
</div>
<a class="anchor" id="aa9814236d331f2e6822435215e9acd8e"></a><!-- doxytag: member="update.fetch.inc::_update_refresh" ref="aa9814236d331f2e6822435215e9acd8e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_update_refresh </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clears out all the cached available update data and initiates re-fetching. </p>

</div>
</div>
<a class="anchor" id="a7975896014a8fc9b4e14306a875b97f2"></a><!-- doxytag: member="update.fetch.inc::update_fetch_data_batch" ref="a7975896014a8fc9b4e14306a875b97f2" args="(&amp;$context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_fetch_data_batch </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>context</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Batch callback: Processes a step in batch for fetching available update data.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$context</em>&nbsp;</td><td>Reference to an array used for Batch API storage. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac901625f220862b797fb5c5cc4dcb654"></a><!-- doxytag: member="update.fetch.inc::update_fetch_data_finished" ref="ac901625f220862b797fb5c5cc4dcb654" args="($success, $results)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_fetch_data_finished </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>success</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>results</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Batch callback: Performs actions when all fetch tasks have been completed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$success</em>&nbsp;</td><td>TRUE if the batch operation was successful; FALSE if there were errors. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$results</em>&nbsp;</td><td>An associative array of results from the batch operation, including the key 'updated' which holds the total number of projects we fetched available update data for. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb92114e3c9f719e50f66ac62ff78e01"></a><!-- doxytag: member="update.fetch.inc::update_manual_status" ref="acb92114e3c9f719e50f66ac62ff78e01" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_manual_status </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Page callback: Checks for updates and displays the update status report.</p>
<p>Manually checks the update status without the use of cron.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="update_8module.html#abfea1a759334c0461fa9ff2250bdfaaf">update_menu()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a3d8f5a924c1de0728c829d3c92d60d19"></a><!-- doxytag: member="update.fetch.inc::update_parse_xml" ref="a3d8f5a924c1de0728c829d3c92d60d19" args="($raw_xml)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">update_parse_xml </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>raw_xml</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Parses the XML of the Drupal release history info files.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$raw_xml</em>&nbsp;</td><td>A raw XML string of available release data for a given project.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Array of parsed data about releases for a given project, or NULL if there was an error parsing the string. </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 8 Nov 2013 for DoSomething.org by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
