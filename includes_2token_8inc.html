<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DoSomething.org: html/includes/token.inc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>html/includes/token.inc File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="includes_2token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace</a> ($text, array $data=array(), array $options=array())</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="includes_2token_8inc.html#a0672a1031161b81dd5aff4476bbc1c99">token_scan</a> ($text)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="includes_2token_8inc.html#abcd5ba5a75b47fe97338243a62d4eecd">token_generate</a> ($type, array $tokens, array $data=array(), array $options=array())</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="includes_2token_8inc.html#ae6241ad02cf636533b0a8304d2df4c1b">token_find_with_prefix</a> (array $tokens, $prefix, $delimiter= ':')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="includes_2token_8inc.html#a24f0543f20ed0c8b807a680e67248704">token_info</a> ()</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Drupal placeholder/token replacement system.</p>
<p>API functions for replacing placeholders in text with meaningful values.</p>
<p>For example: When configuring automated emails, an administrator enters standard text for the email. Variables like the title of a node and the date the email was sent can be entered as placeholders like [node:title] and [date:short]. When a Drupal module prepares to send the email, it can call the <a class="el" href="includes_2token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace()</a> function, passing in the text. The token system will scan the text for placeholder tokens, give other modules an opportunity to replace them with meaningful text, then return the final product to the original module.</p>
<p>Tokens follow the form: [$type:$name], where $type is a general class of tokens like 'node', 'user', or 'comment' and $name is the name of a given placeholder. For example, [node:title] or [node:created:since].</p>
<p>In addition to raw text containing placeholders, modules may pass in an array of objects to be used when performing the replacement. The objects should be keyed by the token type they correspond to. For example:</p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Load a node and a user, then replace tokens in the text.</span>
 $text = <span class="stringliteral">&apos;On [date:short], [user:name] read [node:title].&apos;</span>;
 $node = <a class="code" href="node_8module.html#a492ddfc12843e71242bb484a44e51a19">node_load</a>(1);
 $user = <a class="code" href="user_8module.html#a0f7e67c4e909ca691f57889dd5a72a07">user_load</a>(1);

 <span class="comment">// [date:...] tokens use the current date automatically.</span>
 $data = array(<span class="stringliteral">&apos;node&apos;</span> =&gt; $node, <span class="stringliteral">&apos;user&apos;</span> =&gt; $user);
 <span class="keywordflow">return</span> <a class="code" href="includes_2token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace</a>($text, $data);
</pre></div><p>Some tokens may be chained in the form of [$type:$pointer:$name], where $type is a normal token type, $pointer is a reference to another token type, and $name is the name of a given placeholder. For example, [node:author:mail]. In that example, 'author' is a pointer to the 'user' account that created the node, and 'mail' is a placeholder available for any 'user'.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="includes_2token_8inc.html#a47eb294b05ca8d04439a9a82ccc4d82a">token_replace()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#ga3bfd87d9a19b2397b0f970e1cff7ea4f">hook_tokens()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#gab868597197cf36911f95dcd29ae0b954">hook_token_info()</a> </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae6241ad02cf636533b0a8304d2df4c1b"></a><!-- doxytag: member="token.inc::token_find_with_prefix" ref="ae6241ad02cf636533b0a8304d2df4c1b" args="(array $tokens, $prefix, $delimiter= ':')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">token_find_with_prefix </td>
          <td>(</td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>delimiter</em> = <code>':'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns a list of tokens that begin with a specific prefix.</p>
<p>Used to extract a group of 'chained' tokens (such as [node:author:name]) from the full list of tokens found in text. For example: </p>
<div class="fragment"><pre class="fragment">   $data = array(
     <span class="stringliteral">&apos;author:name&apos;</span> =&gt; <span class="stringliteral">&apos;[node:author:name]&apos;</span>,
     <span class="stringliteral">&apos;title&apos;</span>       =&gt; <span class="stringliteral">&apos;[node:title]&apos;</span>,
     <span class="stringliteral">&apos;created&apos;</span>     =&gt; <span class="stringliteral">&apos;[node:created]&apos;</span>,
   );
   $results = <a class="code" href="includes_2token_8inc.html#ae6241ad02cf636533b0a8304d2df4c1b">token_find_with_prefix</a>($data, <span class="stringliteral">&apos;author&apos;</span>);
   $results == array(<span class="stringliteral">&apos;name&apos;</span> =&gt; <span class="stringliteral">&apos;[node:author:name]&apos;</span>);
</pre></div><dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$tokens</em>&nbsp;</td><td>A keyed array of tokens, and their original raw form in the source text. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$prefix</em>&nbsp;</td><td>A textual string to be matched at the beginning of the token. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$delimiter</em>&nbsp;</td><td>An optional string containing the character that separates the prefix from the rest of the token. Defaults to ':'.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An associative array of discovered tokens, with the prefix and delimiter stripped from the key. </dd></dl>

</div>
</div>
<a class="anchor" id="abcd5ba5a75b47fe97338243a62d4eecd"></a><!-- doxytag: member="token.inc::token_generate" ref="abcd5ba5a75b47fe97338243a62d4eecd" args="($type, array $tokens, array $data=array(), array $options=array())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">token_generate </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>tokens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>data</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>options</em> = <code>array()</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generates replacement values for a list of tokens.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$type</em>&nbsp;</td><td>The type of token being replaced. 'node', 'user', and 'date' are common. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$tokens</em>&nbsp;</td><td>An array of tokens to be replaced, keyed by the literal text of the token as it appeared in the source text. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$data</em>&nbsp;</td><td>(optional) An array of keyed objects. For simple replacement scenarios 'node', 'user', and others are common keys, with an accompanying node or user object being the value. Some token types, like 'site', do not require any explicit information from $data and can be replaced even if it is empty. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$options</em>&nbsp;</td><td>(optional) A keyed array of settings and flags to control the token replacement process. Supported options are:</p>
<ul>
<li>language: A language object to be used when generating locale-sensitive tokens.</li>
<li>callback: A callback function that will be used to post-process the array of token replacements after they are generated. Can be used when modules require special formatting of token text, for example URL encoding or truncation to a specific length.</li>
<li>sanitize: A boolean flag indicating that tokens should be sanitized for display to a web browser. Developers who set this option to FALSE assume responsibility for running <a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss()</a>, <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> or other appropriate scrubbing functions before displaying data to users.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An associative array of replacement values, keyed by the original 'raw' tokens that were found in the source text. For example: $results['[node:title]'] = 'My new node';</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__hooks.html#ga3bfd87d9a19b2397b0f970e1cff7ea4f">hook_tokens()</a> </dd>
<dd>
<a class="el" href="group__hooks.html#gaeeea438e74b29e5603f0ed3f1967a257">hook_tokens_alter()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a24f0543f20ed0c8b807a680e67248704"></a><!-- doxytag: member="token.inc::token_info" ref="a24f0543f20ed0c8b807a680e67248704" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">token_info </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns metadata describing supported tokens.</p>
<p>The metadata array contains token type, name, and description data as well as an optional pointer indicating that the token chains to another set of tokens.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">   $data[<span class="stringliteral">&apos;types&apos;</span>][<span class="stringliteral">&apos;node&apos;</span>] = array(
     <span class="stringliteral">&apos;name&apos;</span> =&gt; t(<span class="stringliteral">&apos;Nodes&apos;</span>),
     <span class="stringliteral">&apos;description&apos;</span> =&gt; t(<span class="stringliteral">&apos;Tokens related to node objects.&apos;</span>),
   );
   $data[<span class="stringliteral">&apos;tokens&apos;</span>][<span class="stringliteral">&apos;node&apos;</span>][<span class="stringliteral">&apos;title&apos;</span>] = array(
     <span class="stringliteral">&apos;name&apos;</span> =&gt; t(<span class="stringliteral">&apos;Title&apos;</span>),
     <span class="stringliteral">&apos;description&apos;</span> =&gt; t(<span class="stringliteral">&apos;The title of the current node.&apos;</span>),
   );
   $data[<span class="stringliteral">&apos;tokens&apos;</span>][<span class="stringliteral">&apos;node&apos;</span>][<span class="stringliteral">&apos;author&apos;</span>] = array(
     <span class="stringliteral">&apos;name&apos;</span> =&gt; t(<span class="stringliteral">&apos;Author&apos;</span>),
     <span class="stringliteral">&apos;description&apos;</span> =&gt; t(<span class="stringliteral">&apos;The author of the current node.&apos;</span>),
     <span class="stringliteral">&apos;type&apos;</span> =&gt; <span class="stringliteral">&apos;user&apos;</span>,
   );
</pre></div><dl class="return"><dt><b>Returns:</b></dt><dd>An associative array of token information, grouped by token type. </dd></dl>

</div>
</div>
<a class="anchor" id="a47eb294b05ca8d04439a9a82ccc4d82a"></a><!-- doxytag: member="token.inc::token_replace" ref="a47eb294b05ca8d04439a9a82ccc4d82a" args="($text, array $data=array(), array $options=array())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">token_replace </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>data</em> = <code>array()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>options</em> = <code>array()</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Replaces all tokens in a given string with appropriate values.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$text</em>&nbsp;</td><td>A string potentially containing replaceable tokens. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$data</em>&nbsp;</td><td>(optional) An array of keyed objects. For simple replacement scenarios 'node', 'user', and others are common keys, with an accompanying node or user object being the value. Some token types, like 'site', do not require any explicit information from $data and can be replaced even if it is empty. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$options</em>&nbsp;</td><td>(optional) A keyed array of settings and flags to control the token replacement process. Supported options are:</p>
<ul>
<li>language: A language object to be used when generating locale-sensitive tokens.</li>
<li>callback: A callback function that will be used to post-process the array of token replacements after they are generated. For example, a module using tokens in a text-only email might provide a callback to strip HTML entities from token values before they are inserted into the final text.</li>
<li>clear: A boolean flag indicating that tokens should be removed from the final text if no replacement value can be generated.</li>
<li>sanitize: A boolean flag indicating that tokens should be sanitized for display to a web browser. Defaults to TRUE. Developers who set this option to FALSE assume responsibility for running <a class="el" href="group__sanitization.html#ga8864a29ffa8de5c9f8dc9e417060660d">filter_xss()</a>, <a class="el" href="group__sanitization.html#ga76fc67a30fd8d75ddd80565e6e65a13d">check_plain()</a> or other appropriate scrubbing functions before displaying data to users.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Text with tokens replaced. </dd></dl>

</div>
</div>
<a class="anchor" id="a0672a1031161b81dd5aff4476bbc1c99"></a><!-- doxytag: member="token.inc::token_scan" ref="a0672a1031161b81dd5aff4476bbc1c99" args="($text)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">token_scan </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>text</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Builds a list of all token-like patterns that appear in the text.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$text</em>&nbsp;</td><td>The text to be scanned for possible tokens.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An associative array of discovered tokens, grouped by type. </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 8 Nov 2013 for DoSomething.org by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
